%
\begin{isabellebody}%
\setisabellecontext{Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharunderscore}{\kern0pt}main{\isacharunderscore}{\kern0pt}proof}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Generalized Cauchy--Davenport theorem: main proof%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharunderscore}{\kern0pt}main{\isacharunderscore}{\kern0pt}proof\isanewline
\ \ \isakeyword{imports}\isanewline
\ \ Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharunderscore}{\kern0pt}preliminaries\isanewline
\ \ {\isachardoublequoteopen}HOL{\isacharminus}{\kern0pt}Library{\isachardot}{\kern0pt}Extended{\isacharunderscore}{\kern0pt}Nat{\isachardoublequoteclose}\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
\isanewline
\isacommand{context}\isamarkupfalse%
\ group\isanewline
\isanewline
\isakeyword{begin}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{The counterexample pair relation in \cite{DeVos2016OnAG}%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}devos{\isacharunderscore}{\kern0pt}rel\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}mlex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ n\ {\isachargreater}{\kern0pt}\ m{\isacharbraceright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ \isanewline
\ \ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}card\ A\ {\isacharplus}{\kern0pt}\ card\ B{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C{\isacharcomma}{\kern0pt}\ D{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ devos{\isacharunderscore}{\kern0pt}rel\ {\isasymlongleftrightarrow}\ card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}C\ {\isasymcdots}\ D{\isacharparenright}{\kern0pt}\ {\isasymor}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}C\ {\isasymcdots}\ D{\isacharparenright}{\kern0pt}\ {\isasymand}\ card\ A\ {\isacharplus}{\kern0pt}\ card\ B\ {\isachargreater}{\kern0pt}\ card\ C\ {\isacharplus}{\kern0pt}\ card\ D{\isacharparenright}{\kern0pt}\ {\isasymor}\isanewline
\ \ {\isacharparenleft}{\kern0pt}card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}C\ {\isasymcdots}\ D{\isacharparenright}{\kern0pt}\ {\isasymand}\ card\ A\ {\isacharplus}{\kern0pt}\ card\ B\ {\isacharequal}{\kern0pt}\ card\ C\ {\isacharplus}{\kern0pt}\ card\ D\ {\isasymand}\ card\ A\ {\isacharless}{\kern0pt}\ card\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}def\ mlex{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C{\isacharcomma}{\kern0pt}\ D{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ devos{\isacharunderscore}{\kern0pt}rel\ {\isasymLongrightarrow}\ card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isasymle}\ card{\isacharparenleft}{\kern0pt}C\ {\isasymcdots}\ D{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Lemma stating that the above relation due to DeVos is well-founded%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}wf\ {\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}Restr\ devos{\isacharunderscore}{\kern0pt}rel\ \isanewline
\ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ finite\ A\ {\isasymand}\ A\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymand}\ A\ {\isasymsubseteq}\ G\ {\isasymand}\ finite\ B\ {\isasymand}\ B\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymand}\ B\ {\isasymsubseteq}\ G{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}Restr\ devos{\isacharunderscore}{\kern0pt}rel\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f\ \isakeyword{where}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}A{\isasymcdots}B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ g\ \isakeyword{where}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharcomma}{\kern0pt}\ B\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}card\ A\ {\isacharplus}{\kern0pt}\ card\ B{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ h\ \isakeyword{where}\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharcomma}{\kern0pt}\ B\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A\ {\isacharplus}{\kern0pt}\ card\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\ \isakeyword{where}\ {\isachardoublequoteopen}s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat{\isacharcomma}{\kern0pt}\ m\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ n\ {\isachargreater}{\kern0pt}\ m{\isacharbraceright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharcomma}{\kern0pt}\ B\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hle{\isadigit{2}}f{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ {\isacharquery}{\kern0pt}fin\ {\isasymLongrightarrow}\ h\ x\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ A\ B\ \isakeyword{where}\ hxAB{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ A\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}card\ B\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}left\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right\ hx\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ x\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ x{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hxAB\ h{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}measure\ f{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ wf{\isacharunderscore}{\kern0pt}Int{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}\ a{\isachardot}{\kern0pt}\ a\ {\isasymin}\ range\ f\ {\isasymLongrightarrow}\ wf\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ \ range\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Restr\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin\ {\isasymsubseteq}\ \isanewline
\ \ \ \ \ \ \ \ Restr\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ x\ {\isacharminus}{\kern0pt}\ h\ x{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}mlex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharcomma}{\kern0pt}\ B\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ hz{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isasymin}\ Restr\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ a\ b\ \isakeyword{where}\ hzab{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}f\ a\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}f\ b\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\ \isakeyword{and}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}h\ a\ {\isachargreater}{\kern0pt}\ h\ b\ {\isasymor}\ h\ a\ {\isacharequal}{\kern0pt}\ h\ b\ {\isasymand}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}a\ {\isasymin}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}b\ {\isasymin}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ h{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ a\ {\isacharminus}{\kern0pt}\ h\ a\ {\isacharless}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ b\ {\isacharminus}{\kern0pt}\ h\ b\ {\isasymor}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ a\ {\isacharminus}{\kern0pt}\ h\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ b\ {\isacharminus}{\kern0pt}\ h\ b\ {\isasymand}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hle{\isadigit{2}}f\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ diff{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}\ le{\isacharunderscore}{\kern0pt}antisym\ nat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ Restr\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ x\ {\isacharminus}{\kern0pt}\ h\ x{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}mlex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hzab\ hz\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mlex{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ x\ {\isacharminus}{\kern0pt}\ h\ x{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}mlex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ wf{\isacharunderscore}{\kern0pt}mlex{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Int{\isacharunderscore}{\kern0pt}commute\ wf{\isacharunderscore}{\kern0pt}Int{\isadigit{1}}\ wf{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}trans\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}fin\ {\isasymtimes}\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ trans{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}less{\isacharunderscore}{\kern0pt}than\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ wf{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}fibers{\isacharunderscore}{\kern0pt}inter{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}than{\isachardoublequoteclose}\ {\isachardoublequoteopen}f{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}fin\ {\isasymtimes}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ {\isachardoublequoteopen}s{\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ measure{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ inf{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}aci{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}less{\isacharunderscore}{\kern0pt}than\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ devos{\isacharunderscore}{\kern0pt}rel{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}def\ mlex{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{$p(G)$ -- the order of the smallest nontrivial finite subgroup of a group: definition and lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
$ecard$ -- definition of cardinality of a set, defined to be $\infty$ for infinite sets%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ ecard\ \isakeyword{where}\ {\isachardoublequoteopen}ecard\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ finite\ A\ then\ card\ A\ else\ {\isasyminfinity}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ ecard{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}finite{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}ecard\ A\ {\isacharequal}{\kern0pt}\ card\ A{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ ecard{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ metis%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
$p(G)$ -- the size of the smallest nontrivial finite subgroup of $G$, set to $\infty$ if none exist%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ p\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ enat\ \isakeyword{where}\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ Inf\ {\isacharparenleft}{\kern0pt}ecard\ {\isacharbackquote}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}H{\isachardot}{\kern0pt}\ subgroup\ H\ G\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}\ {\isasymand}\ H\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ subgroup{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}ge{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}subgroup\ H\ G\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}H\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}finite\ H{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}card\ H\ {\isasymge}\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ p{\isacharunderscore}{\kern0pt}def\ wellorder{\isacharunderscore}{\kern0pt}Inf{\isacharunderscore}{\kern0pt}le{\isadigit{1}}\ ecard{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}finite\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}eqI\ mem{\isacharunderscore}{\kern0pt}Collect{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ subgroup{\isacharunderscore}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}or{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}ge{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}subgroup\ H\ G\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}H\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}infinite\ H\ {\isasymor}\ card\ H\ {\isasymge}\ p{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ subgroup{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}ge\ assms\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Proof of the Generalized Cauchy--Davenport theorem for (non-abelian) groups%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
Generalized Cauchy--Davenport theorem for (non-abelian) groups due to Matt DeVos \cite{DeVos2016OnAG}%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{theorem}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}\isakeyword{in}\ group{\isacharparenright}{\kern0pt}\ Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ hAne{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ hBne{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}B\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ hAG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hBG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}B\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ hAfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ \isakeyword{and}\ hBfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isasymge}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ A\ {\isacharplus}{\kern0pt}\ card\ B\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ hcontr{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ A\ {\isacharplus}{\kern0pt}\ card\ B\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}fin\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ finite\ A\ {\isasymand}\ A\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymand}\ A\ {\isasymsubseteq}\ G\ {\isasymand}\ finite\ B\ {\isasymand}\ B\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymand}\ B\ {\isasymsubseteq}\ G{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ M\ \isakeyword{where}\ {\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ A\ {\isacharplus}{\kern0pt}\ card\ B\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hmemM{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymin}\ M{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ hcontr\ M{\isacharunderscore}{\kern0pt}def\ not{\isacharunderscore}{\kern0pt}le\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ X\ Y\ \isakeyword{where}\ hXYM{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ hmin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}Z{\isachardot}{\kern0pt}\ Z\ {\isasymin}\ M\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}Z{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnotin}\ Restr\ devos{\isacharunderscore}{\kern0pt}rel\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}wf\ wfE{\isacharunderscore}{\kern0pt}min\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ del{\isacharunderscore}{\kern0pt}insts{\isacharparenright}{\kern0pt}\ old{\isachardot}{\kern0pt}prod{\isachardot}{\kern0pt}exhaust{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hXG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hYG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Y\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hXfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ X{\isachardoublequoteclose}\ \isakeyword{and}\ hYfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ \isanewline
\ \ \ \ hXYlt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hXY{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ X\ {\isasymle}\ card\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ hcontr{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ card\ X\ {\isasymle}\ card\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ hinvinj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ inverse\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ inj{\isacharunderscore}{\kern0pt}onI\ invertible\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}inverse\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}M\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}N\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}N\ {\isasymcdots}\ {\isacharquery}{\kern0pt}M\ {\isacharequal}{\kern0pt}\ inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}composition{\isacharunderscore}{\kern0pt}commute\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hNM{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}N\ {\isasymcdots}\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hinvinj\ card{\isacharunderscore}{\kern0pt}image\ subset{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}on\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hM{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}M\ {\isacharequal}{\kern0pt}\ card\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hinvinj\ hXG\ hYG\ card{\isacharunderscore}{\kern0pt}image\ subset{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}on\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hN{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}N\ {\isacharequal}{\kern0pt}\ card\ Y{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hinvinj\ hYG\ card{\isacharunderscore}{\kern0pt}image\ subset{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}on\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hNplusM{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}N\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}M\ {\isacharequal}{\kern0pt}\ card\ X\ {\isacharplus}{\kern0pt}\ card\ Y{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hM\ hN\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}N\ {\isasymcdots}\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ {\isacharquery}{\kern0pt}N\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}M\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ argo\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}N{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}\ {\isasymin}\ M{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ M{\isacharunderscore}{\kern0pt}def\ hXYM\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}N{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnotin}\ devos{\isacharunderscore}{\kern0pt}rel{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hmin\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ card\ Y\ {\isacharless}{\kern0pt}\ card\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hN\ \ hNM\ hNplusM\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hcontr\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hX{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isasymle}\ card\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}\ {\isasymnot}\ {\isadigit{2}}\ {\isasymle}\ card\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ X\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ card{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hX{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ X\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ {\isachardoublequoteopen}X\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymin}\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXG\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ card{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}singletonE\ insert{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}eq\ hYG\ hXYM\ M{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ a\ b\ \isakeyword{where}\ habX{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharbraceright}{\kern0pt}\ {\isasymsubseteq}\ X{\isachardoublequoteclose}\ \isakeyword{and}\ habne{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymnoteq}\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ card{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}iff\ obtain{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isasymin}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ a\ {\isasymcdot}\ b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ habX\ composition{\isacharunderscore}{\kern0pt}closed\ hXG\ insert{\isacharunderscore}{\kern0pt}subset\ \isanewline
\ \ \ \ invertible\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}\ singletonI\ smul{\isachardot}{\kern0pt}smulI\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ g\ \isakeyword{where}\ hgG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymin}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hg{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymnoteq}\ {\isasymone}{\isachardoublequoteclose}\ \isakeyword{and}\ hXgne{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ X\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ habne\ habX\ hXG\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ composition{\isacharunderscore}{\kern0pt}closed\ insert{\isacharunderscore}{\kern0pt}disjoint{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ insert{\isacharunderscore}{\kern0pt}subset\ invertible\ \isanewline
\ \ \ \ \ \ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}\ mk{\isacharunderscore}{\kern0pt}disjoint{\isacharunderscore}{\kern0pt}insert\ right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hpsubX{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ X\ {\isasymsubset}\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ X\ {\isasymsubset}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hXsub{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}sing{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}le\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}\ {\isacartoucheopen}g\ {\isasymin}\ G{\isacartoucheclose}\ card{\isachardot}{\kern0pt}infinite\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}eq\ finite{\isacharunderscore}{\kern0pt}Int\ hXG\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hXfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXsub\ card{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}eq\ finite{\isachardot}{\kern0pt}emptyI\ finite{\isachardot}{\kern0pt}insertI\isanewline
\ \ \ \ \ \ finite{\isacharunderscore}{\kern0pt}smul\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hXpow{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ hXG\ hgG\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}powers{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hfinpowers{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}infinite\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}infinite\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXG\ hX{\isadigit{2}}\ hXpow\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{1}}\ hXgne\ hXsub\ hgG\ \isanewline
\ \ \ \ \ \ \ \ infinite{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right\ invertible\ le{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}inf\ powers{\isacharunderscore}{\kern0pt}submonoid\ submonoid{\isachardot}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right\ \isanewline
\ \ \ \ \ \ powers{\isacharunderscore}{\kern0pt}submonoid\ submonoid{\isachardot}{\kern0pt}subset\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ habX\ hXG\ hXfin\ hgG\ insert{\isacharunderscore}{\kern0pt}subset\ invertible\ \isanewline
\ \ \ \ \ \ subsetD\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isasymle}\ card\ X{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hfinpowers\ hg{\isadigit{1}}\ hgG\ le{\isacharunderscore}{\kern0pt}trans\ powers{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}one\ powers{\isacharunderscore}{\kern0pt}subgroup\ subgroup{\isacharunderscore}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}or{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}ge\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ enat{\isacharunderscore}{\kern0pt}ile\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}left\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ {\isacartoucheopen}b\ {\isasymin}\ smul\ X\ {\isacharbraceleft}{\kern0pt}inverse\ a\ {\isasymcdot}\ b{\isacharbraceright}{\kern0pt}{\isacartoucheclose}\ bot{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}extremum{\isacharunderscore}{\kern0pt}uniqueI\ card{\isachardot}{\kern0pt}infinite\ \isanewline
\ \ \ \ \ \ card{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}eq\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right\ empty{\isacharunderscore}{\kern0pt}iff\ hXY\ hXfin\ hYG\ le{\isacharunderscore}{\kern0pt}trans\ smul{\isachardot}{\kern0pt}cases\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ enat{\isacharunderscore}{\kern0pt}ile\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isasymunion}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isasyminter}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hY{\isadigit{1}}G{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hY{\isadigit{1}}fin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{and}\ hX{\isadigit{2}}G{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hX{\isadigit{2}}fin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharquery}{\kern0pt}X{\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hYfin\ hYG\ hXG\ finite{\isacharunderscore}{\kern0pt}smul\ hXfin\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isasymsubseteq}\ X\ {\isasymcdots}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ y\ \isakeyword{where}\ hz{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ y{\isachardoublequoteclose}\ \isakeyword{and}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharquery}{\kern0pt}X{\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{and}\ hy{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ smul{\isachardot}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ X\ {\isasymcdots}\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}y\ {\isasymin}\ Y{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hz\ hx\ smulI\ hXG\ hYG\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ w\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ inverse\ g\ {\isasymcdot}\ \ w{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}w\ {\isasymin}\ Y{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hy\ smul{\isachardot}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnE\ singletonD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ v\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ v\ {\isasymcdot}\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}v\ {\isasymin}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hx\ smul{\isachardot}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hz\ hXG\ hYG\ hgG\ associative\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ smul{\isachardot}{\kern0pt}smulI\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isasymsubseteq}\ X\ {\isasymcdots}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ y\ \isakeyword{where}\ hz{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ y{\isachardoublequoteclose}\ \isakeyword{and}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharquery}{\kern0pt}X{\isadigit{2}}{\isachardoublequoteclose}\ \isakeyword{and}\ hy{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ smul{\isachardot}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ X\ {\isasymcdots}\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hz\ hy\ smulI\ hXG\ hYG\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ v\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ v\ {\isasymcdot}\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}v\ {\isasymin}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hx\ smul{\isachardot}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnE\ singletonD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ w\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ inverse\ g\ {\isasymcdot}\ w{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}w\ {\isasymin}\ Y{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hy\ smul{\isachardot}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hz\ hXG\ hYG\ hgG\ associative\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ smul{\isachardot}{\kern0pt}smulI\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hY{\isadigit{2}}ne{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ hY{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isasymle}\ card\ Y\ {\isacharplus}{\kern0pt}\ card\ Y{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ hXY{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}disjoint\ hYfin\ hYG\ hgG\ finite{\isacharunderscore}{\kern0pt}smul\ inf{\isachardot}{\kern0pt}orderE\ invertible\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ hY{\isadigit{2}}\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}eq\ finite{\isachardot}{\kern0pt}emptyI\ finite{\isachardot}{\kern0pt}insertI\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ hY{\isadigit{1}}fin\ hY{\isadigit{1}}G{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ hXgne\ hXG\ Int{\isacharunderscore}{\kern0pt}assoc\ Int{\isacharunderscore}{\kern0pt}commute\ ex{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}conv\ finite{\isacharunderscore}{\kern0pt}Int\ hXfin\ smul{\isachardot}{\kern0pt}simps\ smul{\isacharunderscore}{\kern0pt}D{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ smul{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}carrier\ unit{\isacharunderscore}{\kern0pt}closed\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXY{\isadigit{1}}\ finite{\isacharunderscore}{\kern0pt}smul\ card{\isacharunderscore}{\kern0pt}mono\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ hXfin\ hYfin{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hXadd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ card\ X{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}eq\ hgG\ hXfin\ hXG\ card{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}Int\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Un{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}eq{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ add{\isachardot}{\kern0pt}commute\ finite{\isachardot}{\kern0pt}emptyI\ finite{\isachardot}{\kern0pt}insertI\ finite{\isacharunderscore}{\kern0pt}smul\ mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ subset{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hYadd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ card\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}eq\ hgG\ hYfin\ hYG\ card{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}Int\ finite{\isacharunderscore}{\kern0pt}smul\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Int{\isacharunderscore}{\kern0pt}lower{\isadigit{1}}\ Un{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}eq{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ card{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}eq\ card{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}le\ card{\isacharunderscore}{\kern0pt}seteq\ finite{\isachardot}{\kern0pt}emptyI\ finite{\isachardot}{\kern0pt}insertI\ \ \isanewline
\ \ \ \ \ \ hY{\isadigit{2}}ne\ le{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}cancel{\isadigit{1}}\ mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ subset{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isachargreater}{\kern0pt}\ card\ X\ {\isacharplus}{\kern0pt}\ card\ Y{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ hcase{\isacharcolon}{\kern0pt}\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ h\ {\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isasymle}\ card\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{2}}le{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}enat\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hXY{\isadigit{2}}\ finite{\isacharunderscore}{\kern0pt}smul\ card{\isacharunderscore}{\kern0pt}mono\ hXfin\ hYfin\ enat{\isacharunderscore}{\kern0pt}ile\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ h\ enat{\isacharunderscore}{\kern0pt}ile\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ min{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}SIG{\isacharparenright}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le\ order{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less\ order{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}subst{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ order\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{1}}M{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{2}}{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ M{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hY{\isadigit{2}}ne\ hX{\isadigit{2}}fin\ hX{\isadigit{2}}G\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{2}}{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ \ Restr\ devos{\isacharunderscore}{\kern0pt}rel\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ hXY{\isadigit{1}}M\ h\ hXY{\isadigit{2}}le\ \isanewline
\ \ \ \ \ \ \ \ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}iff\ hcase\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hmin\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ hcase{\isacharcolon}{\kern0pt}\ False\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ h{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isasymge}\ card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXadd\ hYadd\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ hX{\isadigit{1}}lt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isacharless}{\kern0pt}\ card\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXfin\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ hpsubX\ psubset{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{1}}le{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}enat\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hXY{\isadigit{1}}\ finite{\isacharunderscore}{\kern0pt}smul\ card{\isacharunderscore}{\kern0pt}mono\ hYfin\ hXfin\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ h\ enat{\isacharunderscore}{\kern0pt}ile\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ min{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}threshold{\isacharparenright}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}linear\ order{\isachardot}{\kern0pt}asym\ order{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}trans{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{1}}M{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ M{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ M{\isacharunderscore}{\kern0pt}def\ hXgne\ hY{\isadigit{1}}fin\ hY{\isadigit{1}}G\ hXYM\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ \ Restr\ devos{\isacharunderscore}{\kern0pt}rel\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ hXY{\isadigit{1}}M\ h\ hXY{\isadigit{1}}le\ \isanewline
\ \ \ \ \ \ \ \ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}iff\ hX{\isadigit{1}}lt\ hXY{\isadigit{1}}le\ hcase\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hmin\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/IsabelleProjects/Generalized_Cauchy_Davenport/Generalized_Cauchy_Davenport_main_proof.thy%:%
%:%11=1%:%
%:%27=14%:%
%:%28=14%:%
%:%29=15%:%
%:%30=16%:%
%:%31=17%:%
%:%32=18%:%
%:%37=18%:%
%:%40=19%:%
%:%41=20%:%
%:%42=20%:%
%:%43=21%:%
%:%44=22%:%
%:%51=24%:%
%:%61=25%:%
%:%62=25%:%
%:%63=26%:%
%:%64=27%:%
%:%65=28%:%
%:%66=29%:%
%:%67=29%:%
%:%68=30%:%
%:%70=32%:%
%:%73=33%:%
%:%77=33%:%
%:%78=33%:%
%:%79=33%:%
%:%84=33%:%
%:%87=34%:%
%:%88=35%:%
%:%89=35%:%
%:%90=36%:%
%:%93=37%:%
%:%97=37%:%
%:%98=37%:%
%:%99=37%:%
%:%108=39%:%
%:%110=40%:%
%:%111=40%:%
%:%112=41%:%
%:%119=42%:%
%:%120=42%:%
%:%121=43%:%
%:%122=43%:%
%:%123=44%:%
%:%124=44%:%
%:%125=45%:%
%:%126=45%:%
%:%127=46%:%
%:%128=46%:%
%:%129=47%:%
%:%130=47%:%
%:%131=48%:%
%:%132=48%:%
%:%133=49%:%
%:%134=49%:%
%:%135=49%:%
%:%136=50%:%
%:%137=50%:%
%:%138=50%:%
%:%139=50%:%
%:%140=51%:%
%:%141=51%:%
%:%142=51%:%
%:%143=52%:%
%:%144=52%:%
%:%145=52%:%
%:%146=53%:%
%:%147=53%:%
%:%148=53%:%
%:%149=53%:%
%:%150=53%:%
%:%151=54%:%
%:%152=54%:%
%:%153=55%:%
%:%154=55%:%
%:%155=55%:%
%:%156=56%:%
%:%157=56%:%
%:%158=56%:%
%:%159=57%:%
%:%160=57%:%
%:%161=58%:%
%:%162=58%:%
%:%163=58%:%
%:%164=59%:%
%:%165=59%:%
%:%166=59%:%
%:%167=60%:%
%:%168=60%:%
%:%169=61%:%
%:%170=61%:%
%:%172=63%:%
%:%173=64%:%
%:%174=64%:%
%:%175=65%:%
%:%176=65%:%
%:%177=65%:%
%:%178=66%:%
%:%179=66%:%
%:%180=66%:%
%:%181=67%:%
%:%182=68%:%
%:%183=69%:%
%:%184=69%:%
%:%185=69%:%
%:%186=70%:%
%:%187=70%:%
%:%188=70%:%
%:%189=71%:%
%:%190=72%:%
%:%191=72%:%
%:%192=72%:%
%:%193=73%:%
%:%194=73%:%
%:%195=73%:%
%:%196=74%:%
%:%197=74%:%
%:%198=74%:%
%:%199=75%:%
%:%200=75%:%
%:%201=76%:%
%:%202=76%:%
%:%203=76%:%
%:%204=77%:%
%:%205=77%:%
%:%206=78%:%
%:%207=78%:%
%:%208=78%:%
%:%209=78%:%
%:%210=79%:%
%:%211=79%:%
%:%212=80%:%
%:%213=80%:%
%:%214=81%:%
%:%215=81%:%
%:%216=81%:%
%:%217=81%:%
%:%218=81%:%
%:%219=82%:%
%:%220=82%:%
%:%221=82%:%
%:%222=83%:%
%:%223=83%:%
%:%224=84%:%
%:%225=84%:%
%:%226=85%:%
%:%227=85%:%
%:%228=85%:%
%:%229=86%:%
%:%230=86%:%
%:%231=86%:%
%:%232=87%:%
%:%233=87%:%
%:%234=87%:%
%:%235=87%:%
%:%236=88%:%
%:%251=90%:%
%:%263=92%:%
%:%265=93%:%
%:%266=93%:%
%:%267=94%:%
%:%268=95%:%
%:%269=95%:%
%:%270=96%:%
%:%271=97%:%
%:%274=98%:%
%:%278=98%:%
%:%279=98%:%
%:%280=98%:%
%:%289=100%:%
%:%291=101%:%
%:%292=101%:%
%:%293=102%:%
%:%294=103%:%
%:%295=103%:%
%:%296=104%:%
%:%297=105%:%
%:%300=106%:%
%:%304=106%:%
%:%305=106%:%
%:%306=107%:%
%:%307=107%:%
%:%312=107%:%
%:%315=108%:%
%:%316=109%:%
%:%317=109%:%
%:%318=110%:%
%:%319=111%:%
%:%321=111%:%
%:%325=111%:%
%:%326=111%:%
%:%327=111%:%
%:%334=111%:%
%:%335=112%:%
%:%336=113%:%
%:%344=115%:%
%:%356=116%:%
%:%358=117%:%
%:%359=117%:%
%:%360=118%:%
%:%361=119%:%
%:%362=120%:%
%:%369=121%:%
%:%370=121%:%
%:%371=122%:%
%:%372=122%:%
%:%373=123%:%
%:%374=123%:%
%:%375=124%:%
%:%376=124%:%
%:%377=125%:%
%:%378=125%:%
%:%379=125%:%
%:%380=125%:%
%:%381=126%:%
%:%382=126%:%
%:%383=126%:%
%:%384=127%:%
%:%385=127%:%
%:%386=127%:%
%:%387=128%:%
%:%388=128%:%
%:%389=129%:%
%:%390=129%:%
%:%391=129%:%
%:%392=130%:%
%:%393=130%:%
%:%394=131%:%
%:%395=131%:%
%:%396=132%:%
%:%397=132%:%
%:%398=133%:%
%:%399=133%:%
%:%400=133%:%
%:%401=133%:%
%:%402=134%:%
%:%403=134%:%
%:%404=135%:%
%:%405=135%:%
%:%406=136%:%
%:%407=136%:%
%:%408=136%:%
%:%409=136%:%
%:%410=137%:%
%:%411=137%:%
%:%412=137%:%
%:%413=138%:%
%:%414=138%:%
%:%415=138%:%
%:%416=139%:%
%:%417=139%:%
%:%418=139%:%
%:%419=140%:%
%:%420=140%:%
%:%421=140%:%
%:%422=141%:%
%:%423=141%:%
%:%424=141%:%
%:%425=142%:%
%:%426=142%:%
%:%427=142%:%
%:%428=143%:%
%:%429=143%:%
%:%430=143%:%
%:%431=143%:%
%:%432=143%:%
%:%433=144%:%
%:%434=144%:%
%:%435=144%:%
%:%436=145%:%
%:%437=145%:%
%:%438=145%:%
%:%439=146%:%
%:%440=146%:%
%:%441=146%:%
%:%442=146%:%
%:%443=146%:%
%:%444=147%:%
%:%445=147%:%
%:%446=147%:%
%:%447=147%:%
%:%448=147%:%
%:%449=148%:%
%:%450=148%:%
%:%451=148%:%
%:%452=148%:%
%:%453=148%:%
%:%454=149%:%
%:%455=149%:%
%:%456=149%:%
%:%457=149%:%
%:%458=149%:%
%:%459=150%:%
%:%460=150%:%
%:%461=151%:%
%:%462=151%:%
%:%463=152%:%
%:%464=152%:%
%:%465=153%:%
%:%466=153%:%
%:%467=154%:%
%:%468=154%:%
%:%469=154%:%
%:%470=154%:%
%:%471=154%:%
%:%472=155%:%
%:%473=155%:%
%:%474=155%:%
%:%475=155%:%
%:%476=156%:%
%:%477=156%:%
%:%478=156%:%
%:%479=156%:%
%:%480=156%:%
%:%481=157%:%
%:%482=157%:%
%:%483=157%:%
%:%484=157%:%
%:%485=158%:%
%:%486=158%:%
%:%487=159%:%
%:%488=159%:%
%:%489=159%:%
%:%490=159%:%
%:%491=159%:%
%:%492=160%:%
%:%493=160%:%
%:%494=161%:%
%:%495=161%:%
%:%496=161%:%
%:%497=161%:%
%:%498=162%:%
%:%499=162%:%
%:%500=162%:%
%:%501=162%:%
%:%502=163%:%
%:%503=164%:%
%:%504=164%:%
%:%505=164%:%
%:%506=165%:%
%:%507=165%:%
%:%508=165%:%
%:%509=166%:%
%:%510=167%:%
%:%511=167%:%
%:%512=168%:%
%:%513=168%:%
%:%514=169%:%
%:%515=169%:%
%:%516=170%:%
%:%517=170%:%
%:%518=170%:%
%:%519=170%:%
%:%520=171%:%
%:%521=171%:%
%:%522=171%:%
%:%523=171%:%
%:%524=172%:%
%:%525=172%:%
%:%526=173%:%
%:%527=173%:%
%:%528=173%:%
%:%529=173%:%
%:%530=173%:%
%:%531=174%:%
%:%532=174%:%
%:%533=174%:%
%:%534=174%:%
%:%535=175%:%
%:%536=175%:%
%:%537=176%:%
%:%538=176%:%
%:%539=176%:%
%:%540=176%:%
%:%541=177%:%
%:%542=177%:%
%:%543=177%:%
%:%544=178%:%
%:%545=178%:%
%:%546=179%:%
%:%547=179%:%
%:%548=180%:%
%:%549=180%:%
%:%550=180%:%
%:%551=180%:%
%:%552=180%:%
%:%553=181%:%
%:%554=182%:%
%:%555=182%:%
%:%556=182%:%
%:%557=182%:%
%:%558=182%:%
%:%559=183%:%
%:%560=183%:%
%:%561=184%:%
%:%562=184%:%
%:%563=184%:%
%:%564=184%:%
%:%565=185%:%
%:%566=186%:%
%:%567=186%:%
%:%568=187%:%
%:%569=187%:%
%:%570=187%:%
%:%571=188%:%
%:%572=188%:%
%:%573=189%:%
%:%574=189%:%
%:%575=190%:%
%:%576=190%:%
%:%577=190%:%
%:%578=190%:%
%:%579=191%:%
%:%580=192%:%
%:%581=193%:%
%:%582=193%:%
%:%583=194%:%
%:%584=194%:%
%:%585=194%:%
%:%586=194%:%
%:%587=194%:%
%:%588=195%:%
%:%589=195%:%
%:%590=196%:%
%:%591=196%:%
%:%592=197%:%
%:%593=197%:%
%:%594=198%:%
%:%595=198%:%
%:%596=199%:%
%:%597=199%:%
%:%598=200%:%
%:%599=200%:%
%:%600=201%:%
%:%601=201%:%
%:%602=201%:%
%:%603=202%:%
%:%604=202%:%
%:%605=203%:%
%:%606=203%:%
%:%607=204%:%
%:%608=204%:%
%:%609=204%:%
%:%610=205%:%
%:%611=205%:%
%:%612=205%:%
%:%613=205%:%
%:%614=206%:%
%:%615=206%:%
%:%616=207%:%
%:%617=207%:%
%:%618=208%:%
%:%619=208%:%
%:%620=209%:%
%:%621=209%:%
%:%622=209%:%
%:%623=209%:%
%:%624=209%:%
%:%625=210%:%
%:%626=210%:%
%:%627=211%:%
%:%628=211%:%
%:%629=212%:%
%:%630=212%:%
%:%631=212%:%
%:%632=212%:%
%:%633=212%:%
%:%634=213%:%
%:%635=213%:%
%:%636=213%:%
%:%637=213%:%
%:%638=213%:%
%:%639=214%:%
%:%640=214%:%
%:%641=214%:%
%:%642=214%:%
%:%643=215%:%
%:%644=215%:%
%:%645=216%:%
%:%646=216%:%
%:%647=217%:%
%:%648=217%:%
%:%649=218%:%
%:%650=218%:%
%:%651=219%:%
%:%652=219%:%
%:%653=220%:%
%:%654=220%:%
%:%655=220%:%
%:%656=221%:%
%:%657=221%:%
%:%658=221%:%
%:%659=221%:%
%:%660=222%:%
%:%661=222%:%
%:%662=223%:%
%:%663=223%:%
%:%664=224%:%
%:%665=224%:%
%:%666=225%:%
%:%667=225%:%
%:%668=225%:%
%:%669=225%:%
%:%670=225%:%
%:%671=226%:%
%:%672=226%:%
%:%673=227%:%
%:%674=227%:%
%:%675=228%:%
%:%676=228%:%
%:%677=228%:%
%:%678=228%:%
%:%679=228%:%
%:%680=229%:%
%:%681=229%:%
%:%682=229%:%
%:%683=229%:%
%:%684=229%:%
%:%685=230%:%
%:%686=230%:%
%:%687=230%:%
%:%688=230%:%
%:%689=231%:%
%:%690=231%:%
%:%691=232%:%
%:%692=232%:%
%:%693=233%:%
%:%694=233%:%
%:%695=234%:%
%:%696=234%:%
%:%697=235%:%
%:%698=235%:%
%:%699=236%:%
%:%700=236%:%
%:%701=237%:%
%:%702=237%:%
%:%703=237%:%
%:%704=238%:%
%:%705=238%:%
%:%706=238%:%
%:%707=238%:%
%:%708=239%:%
%:%709=239%:%
%:%710=240%:%
%:%711=240%:%
%:%712=240%:%
%:%713=240%:%
%:%714=241%:%
%:%715=242%:%
%:%716=242%:%
%:%717=243%:%
%:%718=243%:%
%:%719=243%:%
%:%720=243%:%
%:%721=243%:%
%:%722=244%:%
%:%723=244%:%
%:%724=244%:%
%:%725=244%:%
%:%726=244%:%
%:%727=245%:%
%:%728=245%:%
%:%729=246%:%
%:%730=246%:%
%:%731=247%:%
%:%732=247%:%
%:%733=248%:%
%:%734=248%:%
%:%735=249%:%
%:%736=249%:%
%:%737=250%:%
%:%738=250%:%
%:%739=251%:%
%:%740=251%:%
%:%741=252%:%
%:%742=253%:%
%:%743=253%:%
%:%744=254%:%
%:%745=254%:%
%:%746=255%:%
%:%747=255%:%
%:%748=256%:%
%:%749=256%:%
%:%750=256%:%
%:%751=256%:%
%:%752=257%:%
%:%753=257%:%
%:%754=258%:%
%:%755=258%:%
%:%756=258%:%
%:%757=259%:%
%:%758=259%:%
%:%759=259%:%
%:%760=259%:%
%:%761=259%:%
%:%762=260%:%
%:%763=260%:%
%:%764=260%:%
%:%765=261%:%
%:%766=261%:%
%:%767=262%:%
%:%768=262%:%
%:%769=263%:%
%:%770=263%:%
%:%771=263%:%
%:%772=263%:%
%:%773=264%:%
%:%774=264%:%
%:%775=264%:%
%:%776=264%:%
%:%777=264%:%
%:%778=265%:%
%:%779=265%:%
%:%780=265%:%
%:%781=265%:%
%:%782=266%:%
%:%783=266%:%
%:%784=267%:%
%:%785=267%:%
%:%786=267%:%
%:%787=267%:%
%:%788=267%:%
%:%789=268%:%
%:%790=268%:%
%:%791=269%:%
%:%792=269%:%
%:%793=270%:%
%:%794=270%:%
%:%795=270%:%
%:%796=270%:%
%:%797=270%:%
%:%798=271%:%
%:%799=271%:%
%:%800=271%:%
%:%801=271%:%
%:%802=272%:%
%:%803=272%:%
%:%804=273%:%
%:%805=273%:%
%:%806=273%:%
%:%807=274%:%
%:%808=274%:%
%:%809=274%:%
%:%810=274%:%
%:%811=274%:%
%:%812=275%:%
%:%813=275%:%
%:%814=275%:%
%:%815=275%:%
%:%816=276%:%
%:%817=276%:%
%:%818=277%:%
%:%819=277%:%
%:%820=277%:%
%:%821=277%:%
%:%822=277%:%
%:%823=278%:%
%:%824=278%:%
%:%825=278%:%
%:%826=278%:%
%:%827=279%:%
%:%828=279%:%
%:%829=280%:%
%:%830=280%:%
%:%831=280%:%
%:%832=280%:%
%:%833=280%:%
%:%834=281%:%
%:%835=281%:%
%:%836=282%:%
%:%842=282%:%
%:%847=283%:%
%:%852=284%:%
