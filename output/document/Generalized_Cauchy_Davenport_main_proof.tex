%
\begin{isabellebody}%
\setisabellecontext{Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharunderscore}{\kern0pt}main{\isacharunderscore}{\kern0pt}proof}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Generalized Cauchy--Davenport theorem: main proof%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharunderscore}{\kern0pt}main{\isacharunderscore}{\kern0pt}proof\isanewline
\ \ \isakeyword{imports}\isanewline
\ \ Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharunderscore}{\kern0pt}preliminaries\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
\isanewline
\isacommand{context}\isamarkupfalse%
\ group\isanewline
\isanewline
\isakeyword{begin}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{The counterexample pair relation in \cite{DeVos2016OnAG}%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}devos{\isacharunderscore}{\kern0pt}rel\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}mlex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ n\ {\isachargreater}{\kern0pt}\ m{\isacharbraceright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ \isanewline
\ \ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}card\ A\ {\isacharplus}{\kern0pt}\ card\ B{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C{\isacharcomma}{\kern0pt}\ D{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ devos{\isacharunderscore}{\kern0pt}rel\ {\isasymlongleftrightarrow}\ card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}C\ {\isasymcdots}\ D{\isacharparenright}{\kern0pt}\ {\isasymor}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}C\ {\isasymcdots}\ D{\isacharparenright}{\kern0pt}\ {\isasymand}\ card\ A\ {\isacharplus}{\kern0pt}\ card\ B\ {\isachargreater}{\kern0pt}\ card\ C\ {\isacharplus}{\kern0pt}\ card\ D{\isacharparenright}{\kern0pt}\ {\isasymor}\isanewline
\ \ {\isacharparenleft}{\kern0pt}card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}C\ {\isasymcdots}\ D{\isacharparenright}{\kern0pt}\ {\isasymand}\ card\ A\ {\isacharplus}{\kern0pt}\ card\ B\ {\isacharequal}{\kern0pt}\ card\ C\ {\isacharplus}{\kern0pt}\ card\ D\ {\isasymand}\ card\ A\ {\isacharless}{\kern0pt}\ card\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}def\ mlex{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C{\isacharcomma}{\kern0pt}\ D{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ devos{\isacharunderscore}{\kern0pt}rel\ {\isasymLongrightarrow}\ card{\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isasymle}\ card{\isacharparenleft}{\kern0pt}C\ {\isasymcdots}\ D{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Lemma stating that the above relation due to DeVos is well-founded%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}wf\ {\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}Restr\ devos{\isacharunderscore}{\kern0pt}rel\ \isanewline
\ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ finite\ A\ {\isasymand}\ A\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymand}\ A\ {\isasymsubseteq}\ G\ {\isasymand}\ finite\ B\ {\isasymand}\ B\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymand}\ B\ {\isasymsubseteq}\ G{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}Restr\ devos{\isacharunderscore}{\kern0pt}rel\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f\ \isakeyword{where}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card{\isacharparenleft}{\kern0pt}A{\isasymcdots}B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ g\ \isakeyword{where}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharcomma}{\kern0pt}\ B\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}card\ A\ {\isacharplus}{\kern0pt}\ card\ B{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ h\ \isakeyword{where}\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharcomma}{\kern0pt}\ B\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A\ {\isacharplus}{\kern0pt}\ card\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\ \isakeyword{where}\ {\isachardoublequoteopen}s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat{\isacharcomma}{\kern0pt}\ m\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ n\ {\isachargreater}{\kern0pt}\ m{\isacharbraceright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharcomma}{\kern0pt}\ B\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hle{\isadigit{2}}f{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ {\isacharquery}{\kern0pt}fin\ {\isasymLongrightarrow}\ h\ x\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ A\ B\ \isakeyword{where}\ hxAB{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ A\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}card\ B\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}left\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right\ hx\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}h\ x\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ x{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hxAB\ h{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}measure\ f{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ wf{\isacharunderscore}{\kern0pt}Int{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}\ a{\isachardot}{\kern0pt}\ a\ {\isasymin}\ range\ f\ {\isasymLongrightarrow}\ wf\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ \ range\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Restr\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin\ {\isasymsubseteq}\ \isanewline
\ \ \ \ \ \ \ \ Restr\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ x\ {\isacharminus}{\kern0pt}\ h\ x{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}mlex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharcomma}{\kern0pt}\ B\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ set{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ hz{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isasymin}\ Restr\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ a\ b\ \isakeyword{where}\ hzab{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}f\ a\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}f\ b\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\ \isakeyword{and}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}h\ a\ {\isachargreater}{\kern0pt}\ h\ b\ {\isasymor}\ h\ a\ {\isacharequal}{\kern0pt}\ h\ b\ {\isasymand}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}a\ {\isasymin}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}b\ {\isasymin}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ h{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ a\ {\isacharminus}{\kern0pt}\ h\ a\ {\isacharless}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ b\ {\isacharminus}{\kern0pt}\ h\ b\ {\isasymor}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ a\ {\isacharminus}{\kern0pt}\ h\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ b\ {\isacharminus}{\kern0pt}\ h\ b\ {\isasymand}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hle{\isadigit{2}}f\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ diff{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}\ le{\isacharunderscore}{\kern0pt}antisym\ nat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ Restr\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ x\ {\isacharminus}{\kern0pt}\ h\ x{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}mlex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ y{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hzab\ hz\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mlex{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ f\ x\ {\isacharminus}{\kern0pt}\ h\ x{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}mlex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ wf{\isacharunderscore}{\kern0pt}mlex{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Int{\isacharunderscore}{\kern0pt}commute\ wf{\isacharunderscore}{\kern0pt}Int{\isadigit{1}}\ wf{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}trans\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}fin\ {\isasymtimes}\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ trans{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}Restr\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}less{\isacharunderscore}{\kern0pt}than\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}fin{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ wf{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}fibers{\isacharunderscore}{\kern0pt}inter{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}less{\isacharunderscore}{\kern0pt}than{\isachardoublequoteclose}\ {\isachardoublequoteopen}f{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}fin\ {\isasymtimes}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ {\isachardoublequoteopen}s{\isachardoublequoteclose}\ {\isachardoublequoteopen}g{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ measure{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ inf{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}aci{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}less{\isacharunderscore}{\kern0pt}than\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ devos{\isacharunderscore}{\kern0pt}rel{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}def\ mlex{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{$p(G)$ -- the order of the smallest nontrivial finite subgroup of a group: definition and lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
$p(G)$ -- the size of the smallest nontrivial finite subgroup of $G$, set to $\infty$ if none exist%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ p\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ enat\ \isakeyword{where}\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ Inf\ {\isacharparenleft}{\kern0pt}orderOf\ {\isacharbackquote}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}H{\isachardot}{\kern0pt}\ subgroup\ H\ G\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}\ {\isasymand}\ H\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ subgroup{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}ge{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}subgroup\ H\ G\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}H\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}finite\ H{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}card\ H\ {\isasymge}\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ p{\isacharunderscore}{\kern0pt}def\ wellorder{\isacharunderscore}{\kern0pt}Inf{\isacharunderscore}{\kern0pt}le{\isadigit{1}}\ ecard{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}finite\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}eqI\ mem{\isacharunderscore}{\kern0pt}Collect{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ subgroup{\isacharunderscore}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}or{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}ge{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}subgroup\ H\ G\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}H\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}infinite\ H\ {\isasymor}\ card\ H\ {\isasymge}\ p{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ subgroup{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}ge\ assms\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Proof of the generalized Cauchy--Davenport theorem for (non-abelian) groups%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
Generalized Cauchy--Davenport theorem for (non-abelian) groups due to Matt DeVos \cite{DeVos2016OnAG}%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{theorem}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}\isakeyword{in}\ group{\isacharparenright}{\kern0pt}\ Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ hAne{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ hBne{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}B\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ hAG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hBG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}B\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ hAfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ \isakeyword{and}\ hBfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isasymge}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ A\ {\isacharplus}{\kern0pt}\ card\ B\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharparenright}{\kern0pt}%
\begin{isamarkuptext}%
We will prove the theorem by contradiction%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{assume}\isamarkupfalse%
\ hcontr{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ A\ {\isacharplus}{\kern0pt}\ card\ B\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}fin\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ finite\ A\ {\isasymand}\ A\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymand}\ A\ {\isasymsubseteq}\ G\ {\isasymand}\ finite\ B\ {\isasymand}\ B\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymand}\ B\ {\isasymsubseteq}\ G{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ M\ \isakeyword{where}\ {\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ A\ {\isacharplus}{\kern0pt}\ card\ B\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hmemM{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}A{\isacharcomma}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymin}\ M{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ hcontr\ M{\isacharunderscore}{\kern0pt}def\ not{\isacharunderscore}{\kern0pt}le\ \isacommand{by}\isamarkupfalse%
\ blast%
\begin{isamarkuptext}%
Firstly, extract sets $X$ and $Y$, which are minimal counterexamples of the DeVos relation defined above%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ X\ Y\ \isakeyword{where}\ hXYM{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ hmin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}Z{\isachardot}{\kern0pt}\ Z\ {\isasymin}\ M\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}Z{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnotin}\ Restr\ devos{\isacharunderscore}{\kern0pt}rel\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}wf\ wfE{\isacharunderscore}{\kern0pt}min\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ del{\isacharunderscore}{\kern0pt}insts{\isacharparenright}{\kern0pt}\ old{\isachardot}{\kern0pt}prod{\isachardot}{\kern0pt}exhaust{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hXG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hYG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Y\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hXfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ X{\isachardoublequoteclose}\ \isakeyword{and}\ hYfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ \isanewline
\ \ \ \ hXYlt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hXY{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ X\ {\isasymle}\ card\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ hcontr{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ card\ X\ {\isasymle}\ card\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ hinvinj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ inverse\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ inj{\isacharunderscore}{\kern0pt}onI\ invertible\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}inverse\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}M\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}N\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}N\ {\isasymcdots}\ {\isacharquery}{\kern0pt}M\ {\isacharequal}{\kern0pt}\ inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}composition{\isacharunderscore}{\kern0pt}commute\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hNM{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}N\ {\isasymcdots}\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hinvinj\ card{\isacharunderscore}{\kern0pt}image\ subset{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}on\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hM{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}M\ {\isacharequal}{\kern0pt}\ card\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hinvinj\ hXG\ hYG\ card{\isacharunderscore}{\kern0pt}image\ subset{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}on\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hN{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}N\ {\isacharequal}{\kern0pt}\ card\ Y{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hinvinj\ hYG\ card{\isacharunderscore}{\kern0pt}image\ subset{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}on\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hNplusM{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}N\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}M\ {\isacharequal}{\kern0pt}\ card\ X\ {\isacharplus}{\kern0pt}\ card\ Y{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hM\ hN\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}N\ {\isasymcdots}\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ {\isacharquery}{\kern0pt}N\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}M\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ argo\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}N{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}\ {\isasymin}\ M{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ M{\isacharunderscore}{\kern0pt}def\ hXYM\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}N{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnotin}\ devos{\isacharunderscore}{\kern0pt}rel{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hmin\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ card\ Y\ {\isacharless}{\kern0pt}\ card\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hN\ \ hNM\ hNplusM\ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hcontr\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\begin{isamarkuptext}%
Observe that $X$ contains at least 2 elements, otherwise the proof is easy%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{have}\isamarkupfalse%
\ hX{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isasymle}\ card\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}\ {\isasymnot}\ {\isadigit{2}}\ {\isasymle}\ card\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ X\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ card{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hX{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ X\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ {\isachardoublequoteopen}X\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymin}\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXG\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ card{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}singletonE\ insert{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}eq\ hYG\ hXYM\ M{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ a\ b\ \isakeyword{where}\ habX{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharbraceright}{\kern0pt}\ {\isasymsubseteq}\ X{\isachardoublequoteclose}\ \isakeyword{and}\ habne{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymnoteq}\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ card{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}iff\ obtain{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isasymin}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ a\ {\isasymcdot}\ b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ habX\ composition{\isacharunderscore}{\kern0pt}closed\ hXG\ insert{\isacharunderscore}{\kern0pt}subset\ \isanewline
\ \ \ \ invertible\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}\ singletonI\ smul{\isachardot}{\kern0pt}smulI\ subsetD{\isacharparenright}{\kern0pt}%
\begin{isamarkuptext}%
From this, obtain an element $g \in G$ such that $Xg \cap X \neq \emptyset$%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ g\ \isakeyword{where}\ hgG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymin}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hg{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isasymnoteq}\ {\isasymone}{\isachardoublequoteclose}\ \isakeyword{and}\ hXgne{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ X\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ habne\ habX\ hXG\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ composition{\isacharunderscore}{\kern0pt}closed\ insert{\isacharunderscore}{\kern0pt}disjoint{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ insert{\isacharunderscore}{\kern0pt}subset\ invertible\ \isanewline
\ \ \ \ \ \ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}\ mk{\isacharunderscore}{\kern0pt}disjoint{\isacharunderscore}{\kern0pt}insert\ right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}%
\begin{isamarkuptext}%
Now we show that  $Xg \cap X$ is strict subset of $X$%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{have}\isamarkupfalse%
\ hpsubX{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ X\ {\isasymsubset}\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ X\ {\isasymsubset}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hXsub{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}sing{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}le\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}\ {\isacartoucheopen}g\ {\isasymin}\ G{\isacartoucheclose}\ card{\isachardot}{\kern0pt}infinite\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}eq\ finite{\isacharunderscore}{\kern0pt}Int\ hXG\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hXfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXsub\ card{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}eq\ finite{\isachardot}{\kern0pt}emptyI\ finite{\isachardot}{\kern0pt}insertI\isanewline
\ \ \ \ \ \ finite{\isacharunderscore}{\kern0pt}smul\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hXpow{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ hXG\ hgG\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}powers{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hfinpowers{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}infinite\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}infinite\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXG\ hX{\isadigit{2}}\ hXpow\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{1}}\ hXgne\ hXsub\ hgG\ \isanewline
\ \ \ \ \ \ \ \ infinite{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right\ invertible\ le{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}inf\ powers{\isacharunderscore}{\kern0pt}submonoid\ submonoid{\isachardot}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right\ \isanewline
\ \ \ \ \ \ powers{\isacharunderscore}{\kern0pt}submonoid\ submonoid{\isachardot}{\kern0pt}subset\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ habX\ hXG\ hXfin\ hgG\ insert{\isacharunderscore}{\kern0pt}subset\ invertible\ \isanewline
\ \ \ \ \ \ subsetD\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isasymle}\ card\ X{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hfinpowers\ hg{\isadigit{1}}\ hgG\ le{\isacharunderscore}{\kern0pt}trans\ powers{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}one\ powers{\isacharunderscore}{\kern0pt}subgroup\ subgroup{\isacharunderscore}{\kern0pt}infinite{\isacharunderscore}{\kern0pt}or{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}ge\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ enat{\isacharunderscore}{\kern0pt}ile\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}left\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ {\isacartoucheopen}b\ {\isasymin}\ smul\ X\ {\isacharbraceleft}{\kern0pt}inverse\ a\ {\isasymcdot}\ b{\isacharbraceright}{\kern0pt}{\isacartoucheclose}\ bot{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}extremum{\isacharunderscore}{\kern0pt}uniqueI\ card{\isachardot}{\kern0pt}infinite\ \isanewline
\ \ \ \ \ \ card{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}eq\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right\ empty{\isacharunderscore}{\kern0pt}iff\ hXY\ hXfin\ hYG\ le{\isacharunderscore}{\kern0pt}trans\ smul{\isachardot}{\kern0pt}cases\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ enat{\isacharunderscore}{\kern0pt}ile\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\begin{isamarkuptext}%
Define auxiliary transformationms of sets $X$ and $Y$ to reach a contradiction%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isasymunion}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isasyminter}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hY{\isadigit{1}}G{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hY{\isadigit{1}}fin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{and}\ hX{\isadigit{2}}G{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ hX{\isadigit{2}}fin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharquery}{\kern0pt}X{\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ hYfin\ hYG\ hXG\ finite{\isacharunderscore}{\kern0pt}smul\ hXfin\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isasymsubseteq}\ X\ {\isasymcdots}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ y\ \isakeyword{where}\ hz{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ y{\isachardoublequoteclose}\ \isakeyword{and}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharquery}{\kern0pt}X{\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{and}\ hy{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ smul{\isachardot}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ X\ {\isasymcdots}\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}y\ {\isasymin}\ Y{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hz\ hx\ smulI\ hXG\ hYG\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ w\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ inverse\ g\ {\isasymcdot}\ \ w{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}w\ {\isasymin}\ Y{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hy\ smul{\isachardot}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnE\ singletonD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ v\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ v\ {\isasymcdot}\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}v\ {\isasymin}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hx\ smul{\isachardot}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hz\ hXG\ hYG\ hgG\ associative\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ smul{\isachardot}{\kern0pt}smulI\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isasymsubseteq}\ X\ {\isasymcdots}\ Y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ y\ \isakeyword{where}\ hz{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ y{\isachardoublequoteclose}\ \isakeyword{and}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharquery}{\kern0pt}X{\isadigit{2}}{\isachardoublequoteclose}\ \isakeyword{and}\ hy{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ smul{\isachardot}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ X\ {\isasymcdots}\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hz\ hy\ smulI\ hXG\ hYG\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ v\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ v\ {\isasymcdot}\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}v\ {\isasymin}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hx\ smul{\isachardot}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnE\ singletonD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ w\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ inverse\ g\ {\isasymcdot}\ w{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}w\ {\isasymin}\ Y{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hy\ smul{\isachardot}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hz\ hXG\ hYG\ hgG\ associative\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ smul{\isachardot}{\kern0pt}smulI\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hY{\isadigit{2}}ne{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ hY{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isasymle}\ card\ Y\ {\isacharplus}{\kern0pt}\ card\ Y{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ hXY{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}disjoint\ hYfin\ hYG\ hgG\ finite{\isacharunderscore}{\kern0pt}smul\ inf{\isachardot}{\kern0pt}orderE\ invertible\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ hY{\isadigit{2}}\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}eq\ finite{\isachardot}{\kern0pt}emptyI\ finite{\isachardot}{\kern0pt}insertI\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ hY{\isadigit{1}}fin\ hY{\isadigit{1}}G{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ hXgne\ hXG\ Int{\isacharunderscore}{\kern0pt}assoc\ Int{\isacharunderscore}{\kern0pt}commute\ ex{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}conv\ finite{\isacharunderscore}{\kern0pt}Int\ hXfin\ smul{\isachardot}{\kern0pt}simps\ smul{\isacharunderscore}{\kern0pt}D{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ smul{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}carrier\ unit{\isacharunderscore}{\kern0pt}closed\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXY{\isadigit{1}}\ finite{\isacharunderscore}{\kern0pt}smul\ card{\isacharunderscore}{\kern0pt}mono\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ hXfin\ hYfin{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hXadd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ card\ X{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}eq\ hgG\ hXfin\ hXG\ card{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}Int\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Un{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}eq{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ add{\isachardot}{\kern0pt}commute\ finite{\isachardot}{\kern0pt}emptyI\ finite{\isachardot}{\kern0pt}insertI\ finite{\isacharunderscore}{\kern0pt}smul\ mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ subset{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ hYadd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ card\ Y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}eq\ hgG\ hYfin\ hYG\ card{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}Int\ finite{\isacharunderscore}{\kern0pt}smul\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Int{\isacharunderscore}{\kern0pt}lower{\isadigit{1}}\ Un{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}eq{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ card{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}eq\ card{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}le\ card{\isacharunderscore}{\kern0pt}seteq\ finite{\isachardot}{\kern0pt}emptyI\ finite{\isachardot}{\kern0pt}insertI\ \ \isanewline
\ \ \ \ \ \ hY{\isadigit{2}}ne\ le{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}cancel{\isadigit{1}}\ mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ subset{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\begin{isamarkuptext}%
Split the contradiction proof into the cases based on whether $|?X2| + |?Y2| > |X| + |Y|$ holds%
\end{isamarkuptext}\isamarkuptrue%
\ \ \isacommand{show}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isachargreater}{\kern0pt}\ card\ X\ {\isacharplus}{\kern0pt}\ card\ Y{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ hcase{\isacharcolon}{\kern0pt}\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ h\ {\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isasymle}\ card\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{2}}le{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}enat\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hXY{\isadigit{2}}\ finite{\isacharunderscore}{\kern0pt}smul\ card{\isacharunderscore}{\kern0pt}mono\ hXfin\ hYfin\ enat{\isacharunderscore}{\kern0pt}ile\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ h\ enat{\isacharunderscore}{\kern0pt}ile\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ min{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}SIG{\isacharparenright}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le\ order{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less\ order{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}subst{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ {\isacharquery}{\kern0pt}X{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ order\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{1}}M{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{2}}{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ M{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hY{\isadigit{2}}ne\ hX{\isadigit{2}}fin\ hX{\isadigit{2}}G\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast%
\begin{isamarkuptext}%
Show that $(?X2, ?Y2)$ is a smaller counterexample for the DeVos relation%
\end{isamarkuptext}\isamarkuptrue%
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{2}}{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}Y{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ \ Restr\ devos{\isacharunderscore}{\kern0pt}rel\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ hXY{\isadigit{1}}M\ h\ hXY{\isadigit{2}}le\ \isanewline
\ \ \ \ \ \ \ \ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}iff\ hcase\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ hmin\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ hcase{\isacharcolon}{\kern0pt}\ False\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ h{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isasymge}\ card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXadd\ hYadd\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ hX{\isadigit{1}}lt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isacharless}{\kern0pt}\ card\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXfin\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ hpsubX\ psubset{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{1}}le{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}enat\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isasymcdots}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hXY{\isadigit{1}}\ finite{\isacharunderscore}{\kern0pt}smul\ card{\isacharunderscore}{\kern0pt}mono\ hYfin\ hXfin\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharless}{\kern0pt}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ X\ {\isacharplus}{\kern0pt}\ card\ Y\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYlt\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ min\ p\ {\isacharparenleft}{\kern0pt}card\ {\isacharquery}{\kern0pt}X{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ h\ enat{\isacharunderscore}{\kern0pt}ile\ enat{\isacharunderscore}{\kern0pt}ord{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ min{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}threshold{\isacharparenright}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}linear\ order{\isachardot}{\kern0pt}asym\ order{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}trans{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hXY{\isadigit{1}}M{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ M{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ M{\isacharunderscore}{\kern0pt}def\ hXgne\ hY{\isadigit{1}}fin\ hY{\isadigit{1}}G\ hXYM\ \isacommand{by}\isamarkupfalse%
\ blast%
\begin{isamarkuptext}%
Show that $(?X1, ?Y1)$ is a smaller counterexample for the DeVos relation%
\end{isamarkuptext}\isamarkuptrue%
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}X{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isacharquery}{\kern0pt}Y{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X{\isacharcomma}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ \ Restr\ devos{\isacharunderscore}{\kern0pt}rel\ {\isacharquery}{\kern0pt}fin{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hXYM\ M{\isacharunderscore}{\kern0pt}def\ hXY{\isadigit{1}}M\ h\ hXY{\isadigit{1}}le\ \isanewline
\ \ \ \ \ \ \ \ devos{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}iff\ hX{\isadigit{1}}lt\ hXY{\isadigit{1}}le\ hcase\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hmin\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/IsabelleProjects/Generalized_Cauchy_Davenport/Generalized_Cauchy_Davenport_main_proof.thy%:%
%:%11=1%:%
%:%27=14%:%
%:%28=14%:%
%:%29=15%:%
%:%30=16%:%
%:%31=17%:%
%:%36=17%:%
%:%39=18%:%
%:%40=19%:%
%:%41=19%:%
%:%42=20%:%
%:%43=21%:%
%:%50=23%:%
%:%60=24%:%
%:%61=24%:%
%:%62=25%:%
%:%63=26%:%
%:%64=27%:%
%:%65=28%:%
%:%66=28%:%
%:%67=29%:%
%:%69=31%:%
%:%72=32%:%
%:%76=32%:%
%:%77=32%:%
%:%78=32%:%
%:%83=32%:%
%:%86=33%:%
%:%87=34%:%
%:%88=34%:%
%:%89=35%:%
%:%92=36%:%
%:%96=36%:%
%:%97=36%:%
%:%98=36%:%
%:%107=38%:%
%:%109=39%:%
%:%110=39%:%
%:%111=40%:%
%:%118=41%:%
%:%119=41%:%
%:%120=42%:%
%:%121=42%:%
%:%122=43%:%
%:%123=43%:%
%:%124=44%:%
%:%125=44%:%
%:%126=45%:%
%:%127=45%:%
%:%128=46%:%
%:%129=46%:%
%:%130=47%:%
%:%131=47%:%
%:%132=48%:%
%:%133=48%:%
%:%134=48%:%
%:%135=49%:%
%:%136=49%:%
%:%137=49%:%
%:%138=49%:%
%:%139=50%:%
%:%140=50%:%
%:%141=50%:%
%:%142=51%:%
%:%143=51%:%
%:%144=51%:%
%:%145=52%:%
%:%146=52%:%
%:%147=52%:%
%:%148=52%:%
%:%149=52%:%
%:%150=53%:%
%:%151=53%:%
%:%152=54%:%
%:%153=54%:%
%:%154=54%:%
%:%155=55%:%
%:%156=55%:%
%:%157=55%:%
%:%158=56%:%
%:%159=56%:%
%:%160=57%:%
%:%161=57%:%
%:%162=57%:%
%:%163=58%:%
%:%164=58%:%
%:%165=58%:%
%:%166=59%:%
%:%167=59%:%
%:%168=60%:%
%:%169=60%:%
%:%171=62%:%
%:%172=63%:%
%:%173=63%:%
%:%174=64%:%
%:%175=64%:%
%:%176=64%:%
%:%177=65%:%
%:%178=65%:%
%:%179=65%:%
%:%180=66%:%
%:%181=67%:%
%:%182=68%:%
%:%183=68%:%
%:%184=68%:%
%:%185=69%:%
%:%186=69%:%
%:%187=69%:%
%:%188=70%:%
%:%189=71%:%
%:%190=71%:%
%:%191=71%:%
%:%192=72%:%
%:%193=72%:%
%:%194=72%:%
%:%195=73%:%
%:%196=73%:%
%:%197=73%:%
%:%198=74%:%
%:%199=74%:%
%:%200=75%:%
%:%201=75%:%
%:%202=75%:%
%:%203=76%:%
%:%204=76%:%
%:%205=77%:%
%:%206=77%:%
%:%207=77%:%
%:%208=77%:%
%:%209=78%:%
%:%210=78%:%
%:%211=79%:%
%:%212=79%:%
%:%213=80%:%
%:%214=80%:%
%:%215=80%:%
%:%216=80%:%
%:%217=80%:%
%:%218=81%:%
%:%219=81%:%
%:%220=81%:%
%:%221=82%:%
%:%222=82%:%
%:%223=83%:%
%:%224=83%:%
%:%225=84%:%
%:%226=84%:%
%:%227=84%:%
%:%228=85%:%
%:%229=85%:%
%:%230=85%:%
%:%231=86%:%
%:%232=86%:%
%:%233=86%:%
%:%234=86%:%
%:%235=87%:%
%:%250=89%:%
%:%262=91%:%
%:%264=92%:%
%:%265=92%:%
%:%266=93%:%
%:%267=94%:%
%:%268=94%:%
%:%269=95%:%
%:%270=96%:%
%:%273=97%:%
%:%277=97%:%
%:%278=97%:%
%:%279=98%:%
%:%280=98%:%
%:%285=98%:%
%:%288=99%:%
%:%289=100%:%
%:%290=100%:%
%:%291=101%:%
%:%292=102%:%
%:%294=102%:%
%:%298=102%:%
%:%299=102%:%
%:%300=102%:%
%:%307=102%:%
%:%308=103%:%
%:%309=104%:%
%:%317=106%:%
%:%329=107%:%
%:%331=108%:%
%:%332=108%:%
%:%333=109%:%
%:%334=110%:%
%:%335=111%:%
%:%342=112%:%
%:%343=112%:%
%:%345=113%:%
%:%347=114%:%
%:%348=114%:%
%:%349=115%:%
%:%350=115%:%
%:%351=116%:%
%:%352=116%:%
%:%353=117%:%
%:%354=117%:%
%:%355=117%:%
%:%356=117%:%
%:%358=118%:%
%:%360=119%:%
%:%361=119%:%
%:%362=119%:%
%:%363=120%:%
%:%364=120%:%
%:%365=120%:%
%:%366=121%:%
%:%367=121%:%
%:%368=122%:%
%:%369=122%:%
%:%370=122%:%
%:%371=123%:%
%:%372=123%:%
%:%373=124%:%
%:%374=124%:%
%:%375=125%:%
%:%376=125%:%
%:%377=126%:%
%:%378=126%:%
%:%379=126%:%
%:%380=126%:%
%:%381=127%:%
%:%382=127%:%
%:%383=128%:%
%:%384=128%:%
%:%385=129%:%
%:%386=129%:%
%:%387=129%:%
%:%388=129%:%
%:%389=130%:%
%:%390=130%:%
%:%391=130%:%
%:%392=131%:%
%:%393=131%:%
%:%394=131%:%
%:%395=132%:%
%:%396=132%:%
%:%397=132%:%
%:%398=133%:%
%:%399=133%:%
%:%400=133%:%
%:%401=134%:%
%:%402=134%:%
%:%403=134%:%
%:%404=135%:%
%:%405=135%:%
%:%406=135%:%
%:%407=136%:%
%:%408=136%:%
%:%409=136%:%
%:%410=136%:%
%:%411=136%:%
%:%412=137%:%
%:%413=137%:%
%:%414=137%:%
%:%415=138%:%
%:%416=138%:%
%:%417=138%:%
%:%418=139%:%
%:%419=139%:%
%:%420=139%:%
%:%421=139%:%
%:%422=139%:%
%:%423=140%:%
%:%424=140%:%
%:%425=140%:%
%:%426=140%:%
%:%427=140%:%
%:%428=141%:%
%:%429=141%:%
%:%430=141%:%
%:%431=141%:%
%:%432=141%:%
%:%433=142%:%
%:%434=142%:%
%:%435=142%:%
%:%436=142%:%
%:%437=142%:%
%:%438=143%:%
%:%441=144%:%
%:%443=145%:%
%:%444=145%:%
%:%445=146%:%
%:%446=146%:%
%:%447=147%:%
%:%448=147%:%
%:%449=148%:%
%:%450=148%:%
%:%451=148%:%
%:%452=148%:%
%:%453=148%:%
%:%454=149%:%
%:%455=149%:%
%:%456=149%:%
%:%457=149%:%
%:%458=150%:%
%:%459=150%:%
%:%460=150%:%
%:%461=150%:%
%:%462=150%:%
%:%463=151%:%
%:%464=151%:%
%:%465=151%:%
%:%466=151%:%
%:%467=152%:%
%:%468=152%:%
%:%469=153%:%
%:%470=153%:%
%:%471=153%:%
%:%472=153%:%
%:%473=153%:%
%:%474=154%:%
%:%475=154%:%
%:%476=155%:%
%:%477=155%:%
%:%478=155%:%
%:%479=155%:%
%:%480=156%:%
%:%481=156%:%
%:%482=156%:%
%:%483=156%:%
%:%484=157%:%
%:%486=158%:%
%:%488=159%:%
%:%489=159%:%
%:%490=159%:%
%:%491=160%:%
%:%492=160%:%
%:%493=160%:%
%:%494=161%:%
%:%496=162%:%
%:%498=163%:%
%:%499=163%:%
%:%500=164%:%
%:%501=164%:%
%:%502=165%:%
%:%503=165%:%
%:%504=166%:%
%:%505=166%:%
%:%506=166%:%
%:%507=166%:%
%:%508=167%:%
%:%509=167%:%
%:%510=167%:%
%:%511=167%:%
%:%512=168%:%
%:%513=168%:%
%:%514=169%:%
%:%515=169%:%
%:%516=169%:%
%:%517=169%:%
%:%518=169%:%
%:%519=170%:%
%:%520=170%:%
%:%521=170%:%
%:%522=170%:%
%:%523=171%:%
%:%524=171%:%
%:%525=172%:%
%:%526=172%:%
%:%527=172%:%
%:%528=172%:%
%:%529=173%:%
%:%530=173%:%
%:%531=173%:%
%:%532=174%:%
%:%533=174%:%
%:%534=175%:%
%:%535=175%:%
%:%536=176%:%
%:%537=176%:%
%:%538=176%:%
%:%539=176%:%
%:%540=176%:%
%:%541=177%:%
%:%542=178%:%
%:%543=178%:%
%:%544=178%:%
%:%545=178%:%
%:%546=178%:%
%:%547=179%:%
%:%548=179%:%
%:%549=180%:%
%:%550=180%:%
%:%551=180%:%
%:%552=180%:%
%:%553=181%:%
%:%554=182%:%
%:%555=182%:%
%:%556=183%:%
%:%557=183%:%
%:%558=183%:%
%:%559=184%:%
%:%560=184%:%
%:%561=185%:%
%:%562=185%:%
%:%563=186%:%
%:%564=186%:%
%:%565=186%:%
%:%566=186%:%
%:%567=187%:%
%:%568=188%:%
%:%569=189%:%
%:%570=189%:%
%:%571=190%:%
%:%572=190%:%
%:%573=190%:%
%:%574=190%:%
%:%575=190%:%
%:%576=191%:%
%:%579=192%:%
%:%581=193%:%
%:%582=193%:%
%:%583=194%:%
%:%584=194%:%
%:%585=195%:%
%:%586=195%:%
%:%587=196%:%
%:%588=196%:%
%:%589=197%:%
%:%590=197%:%
%:%591=198%:%
%:%592=198%:%
%:%593=198%:%
%:%594=199%:%
%:%595=199%:%
%:%596=200%:%
%:%597=200%:%
%:%598=201%:%
%:%599=201%:%
%:%600=201%:%
%:%601=202%:%
%:%602=202%:%
%:%603=202%:%
%:%604=202%:%
%:%605=203%:%
%:%606=203%:%
%:%607=204%:%
%:%608=204%:%
%:%609=205%:%
%:%610=205%:%
%:%611=206%:%
%:%612=206%:%
%:%613=206%:%
%:%614=206%:%
%:%615=206%:%
%:%616=207%:%
%:%617=207%:%
%:%618=208%:%
%:%619=208%:%
%:%620=209%:%
%:%621=209%:%
%:%622=209%:%
%:%623=209%:%
%:%624=209%:%
%:%625=210%:%
%:%626=210%:%
%:%627=210%:%
%:%628=210%:%
%:%629=210%:%
%:%630=211%:%
%:%631=211%:%
%:%632=211%:%
%:%633=211%:%
%:%634=212%:%
%:%635=212%:%
%:%636=213%:%
%:%637=213%:%
%:%638=214%:%
%:%639=214%:%
%:%640=215%:%
%:%641=215%:%
%:%642=216%:%
%:%643=216%:%
%:%644=217%:%
%:%645=217%:%
%:%646=217%:%
%:%647=218%:%
%:%648=218%:%
%:%649=218%:%
%:%650=218%:%
%:%651=219%:%
%:%652=219%:%
%:%653=220%:%
%:%654=220%:%
%:%655=221%:%
%:%656=221%:%
%:%657=222%:%
%:%658=222%:%
%:%659=222%:%
%:%660=222%:%
%:%661=222%:%
%:%662=223%:%
%:%663=223%:%
%:%664=224%:%
%:%665=224%:%
%:%666=225%:%
%:%667=225%:%
%:%668=225%:%
%:%669=225%:%
%:%670=225%:%
%:%671=226%:%
%:%672=226%:%
%:%673=226%:%
%:%674=226%:%
%:%675=226%:%
%:%676=227%:%
%:%677=227%:%
%:%678=227%:%
%:%679=227%:%
%:%680=228%:%
%:%681=228%:%
%:%682=229%:%
%:%683=229%:%
%:%684=230%:%
%:%685=230%:%
%:%686=231%:%
%:%687=231%:%
%:%688=232%:%
%:%689=232%:%
%:%690=233%:%
%:%691=233%:%
%:%692=234%:%
%:%693=234%:%
%:%694=234%:%
%:%695=235%:%
%:%696=235%:%
%:%697=235%:%
%:%698=235%:%
%:%699=236%:%
%:%700=236%:%
%:%701=237%:%
%:%702=237%:%
%:%703=237%:%
%:%704=237%:%
%:%705=238%:%
%:%706=239%:%
%:%707=239%:%
%:%708=240%:%
%:%709=240%:%
%:%710=240%:%
%:%711=240%:%
%:%712=240%:%
%:%713=241%:%
%:%714=241%:%
%:%715=241%:%
%:%716=241%:%
%:%717=241%:%
%:%718=242%:%
%:%719=242%:%
%:%720=243%:%
%:%721=243%:%
%:%722=244%:%
%:%723=244%:%
%:%724=245%:%
%:%725=245%:%
%:%726=246%:%
%:%727=246%:%
%:%728=247%:%
%:%729=247%:%
%:%730=248%:%
%:%731=248%:%
%:%732=249%:%
%:%734=250%:%
%:%736=251%:%
%:%737=251%:%
%:%738=252%:%
%:%739=252%:%
%:%740=253%:%
%:%741=253%:%
%:%742=254%:%
%:%743=254%:%
%:%744=254%:%
%:%745=254%:%
%:%746=255%:%
%:%747=255%:%
%:%748=256%:%
%:%749=256%:%
%:%750=256%:%
%:%751=257%:%
%:%752=257%:%
%:%753=257%:%
%:%754=257%:%
%:%755=257%:%
%:%756=258%:%
%:%757=258%:%
%:%758=258%:%
%:%759=259%:%
%:%760=259%:%
%:%761=260%:%
%:%762=260%:%
%:%763=261%:%
%:%764=261%:%
%:%765=261%:%
%:%766=261%:%
%:%767=262%:%
%:%768=262%:%
%:%769=262%:%
%:%770=262%:%
%:%771=262%:%
%:%773=263%:%
%:%775=264%:%
%:%776=264%:%
%:%777=264%:%
%:%778=264%:%
%:%779=265%:%
%:%780=265%:%
%:%781=266%:%
%:%782=266%:%
%:%783=266%:%
%:%784=266%:%
%:%785=266%:%
%:%786=267%:%
%:%787=267%:%
%:%788=268%:%
%:%789=268%:%
%:%790=269%:%
%:%791=269%:%
%:%792=269%:%
%:%793=269%:%
%:%794=269%:%
%:%795=270%:%
%:%796=270%:%
%:%797=270%:%
%:%798=270%:%
%:%799=271%:%
%:%800=271%:%
%:%801=272%:%
%:%802=272%:%
%:%803=272%:%
%:%804=273%:%
%:%805=273%:%
%:%806=273%:%
%:%807=273%:%
%:%808=273%:%
%:%809=274%:%
%:%810=274%:%
%:%811=274%:%
%:%812=274%:%
%:%813=275%:%
%:%814=275%:%
%:%815=276%:%
%:%816=276%:%
%:%817=276%:%
%:%818=276%:%
%:%819=276%:%
%:%821=277%:%
%:%823=278%:%
%:%824=278%:%
%:%825=278%:%
%:%826=278%:%
%:%827=279%:%
%:%828=279%:%
%:%829=280%:%
%:%830=280%:%
%:%831=280%:%
%:%832=280%:%
%:%833=280%:%
%:%834=281%:%
%:%835=281%:%
%:%836=282%:%
%:%842=282%:%
%:%847=283%:%
%:%852=284%:%
