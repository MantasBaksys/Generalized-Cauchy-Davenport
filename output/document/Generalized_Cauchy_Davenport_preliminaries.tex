%
\begin{isabellebody}%
\setisabellecontext{Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharunderscore}{\kern0pt}preliminaries}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Preliminaries on well-orderings, groups, and sumsets%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Generalized{\isacharunderscore}{\kern0pt}Cauchy{\isacharunderscore}{\kern0pt}Davenport{\isacharunderscore}{\kern0pt}preliminaries\isanewline
\ \ \isakeyword{imports}\ \isanewline
\ Complex{\isacharunderscore}{\kern0pt}Main\isanewline
\ {\isachardoublequoteopen}Jacobson{\isacharunderscore}{\kern0pt}Basic{\isacharunderscore}{\kern0pt}Algebra{\isachardot}{\kern0pt}Group{\isacharunderscore}{\kern0pt}Theory{\isachardoublequoteclose}\ \isanewline
\ {\isachardoublequoteopen}HOL{\isacharminus}{\kern0pt}Library{\isachardot}{\kern0pt}Extended{\isacharunderscore}{\kern0pt}Nat{\isachardoublequoteclose}\isanewline
\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Well-ordering lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ wf{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}fibers{\isacharunderscore}{\kern0pt}inter{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{fixes}\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\ \isakeyword{and}\ s\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\ \isakeyword{and}\ f\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}c\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ \isakeyword{and}\ g\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}c\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ t\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}c\ {\isasymtimes}\ {\isacharprime}{\kern0pt}c{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ h{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ r\ f{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ h{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ a{\isachardot}{\kern0pt}\ a\ {\isasymin}\ range\ f\ {\isasymLongrightarrow}\ wf\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ h{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}trans\ t{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ h{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ range\ f{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ range\ f{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ r\ f\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}\ {\isasymunion}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ range\ f{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t\isanewline
\ \ \ \ {\isasymsubseteq}\ inv{\isacharunderscore}{\kern0pt}image\ r\ f\ {\isasyminter}\ t\ {\isasymunion}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}a{\isasymin}range\ f{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ inv{\isacharunderscore}{\kern0pt}image\ s\ g\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\ \isacommand{assume}\isamarkupfalse%
\ hy{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ a\ b\ \isakeyword{where}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ a{\isacharcomma}{\kern0pt}\ f\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ r\ {\isasymor}\ {\isacharparenleft}{\kern0pt}f\ a\ {\isacharequal}{\kern0pt}\ f\ b\ {\isasymand}\ {\isacharparenleft}{\kern0pt}g\ a{\isacharcomma}{\kern0pt}\ g\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ in{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}prod\ Int{\isacharunderscore}{\kern0pt}iff\ SigmaE\ UNIV{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}UNIV\ inf{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}right\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ inv{\isacharunderscore}{\kern0pt}image\ r\ f\ {\isasyminter}\ t\ {\isasymunion}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}a{\isasymin}range\ f{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ inv{\isacharunderscore}{\kern0pt}image\ s\ g\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hy\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}inv{\isacharunderscore}{\kern0pt}image\ r\ f\ {\isasyminter}\ t\ {\isasymunion}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}a{\isasymin}range\ f{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ inv{\isacharunderscore}{\kern0pt}image\ s\ g\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ \isanewline
\ \ \ \ \ \ inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ Int{\isacharunderscore}{\kern0pt}iff\ SUP{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}iff\ SigmaD{\isadigit{1}}\ SigmaD{\isadigit{2}}\ \isanewline
\ \ \ \ \ \ in{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ in{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}prod\ mem{\isacharunderscore}{\kern0pt}Collect{\isacharunderscore}{\kern0pt}eq\ subrelI\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ r\ f{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}\ O\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ range\ f{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ r\ f{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isachardoublequoteclose}\isanewline
\ \ \ \isacommand{using}\isamarkupfalse%
\ h{\isadigit{3}}\ trans{\isacharunderscore}{\kern0pt}O{\isacharunderscore}{\kern0pt}subset\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ range\ f{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ wf{\isacharunderscore}{\kern0pt}UN{\isacharcomma}{\kern0pt}\ auto\ simp\ add{\isacharcolon}{\kern0pt}\ h{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ wf{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}compatible{\isacharbrackleft}{\kern0pt}OF\ h{\isadigit{1}}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ wf{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}fibers{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{fixes}\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\ \isakeyword{and}\ s\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\ \isakeyword{and}\ f\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}c\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ \isakeyword{and}\ g\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}c\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ h{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ r\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ h{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}\ a{\isachardot}{\kern0pt}\ a\ {\isasymin}\ range\ f\ {\isasymLongrightarrow}\ wf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharequal}{\kern0pt}\ a{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ s\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}wf\ {\isacharparenleft}{\kern0pt}inv{\isacharunderscore}{\kern0pt}image\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}{\isacharasterisk}{\kern0pt}lex{\isacharasterisk}{\kern0pt}{\isachargreater}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ c{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ c{\isacharcomma}{\kern0pt}\ g\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ trans{\isacharunderscore}{\kern0pt}def\ wf{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}lex{\isacharunderscore}{\kern0pt}fibers{\isacharunderscore}{\kern0pt}inter{\isacharbrackleft}{\kern0pt}of\ r\ f\ UNIV\ s\ g{\isacharbrackright}{\kern0pt}\ inf{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}right\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ iso{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}UNIV{\isacharunderscore}{\kern0pt}I{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{context}\isamarkupfalse%
\ monoid\isanewline
\isanewline
\isakeyword{begin}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Pointwise set multiplication in a monoid: definition and key lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{inductive{\isacharunderscore}{\kern0pt}set}\isamarkupfalse%
\ smul\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set{\isachardoublequoteclose}\ \isakeyword{for}\ A\ B\ \isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ smulI{\isacharbrackleft}{\kern0pt}intro{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}a\ {\isasymin}\ A{\isacharsemicolon}{\kern0pt}\ a\ {\isasymin}\ M{\isacharsemicolon}{\kern0pt}\ b\ {\isasymin}\ B{\isacharsemicolon}{\kern0pt}\ b\ {\isasymin}\ M{\isasymrbrakk}\ {\isasymLongrightarrow}\ a\ {\isasymcdot}\ b\ {\isasymin}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{syntax}\isamarkupfalse%
\ {\isachardoublequoteopen}smul{\isachardoublequoteclose}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isasymcdots}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}c{\isachardot}{\kern0pt}\ {\isasymexists}a\ {\isasymin}\ A\ {\isasyminter}\ M{\isachardot}{\kern0pt}\ {\isasymexists}b\ {\isasymin}\ B\ {\isasyminter}\ M{\isachardot}{\kern0pt}\ c\ {\isacharequal}{\kern0pt}\ a\ {\isasymcdot}\ b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isachardot}{\kern0pt}simps\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ smul{\isachardot}{\kern0pt}cases{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}a\ {\isasymin}\ A\ {\isasyminter}\ M{\isachardot}{\kern0pt}\ {\isasymUnion}b\ {\isasymin}\ B\ {\isasyminter}\ M{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a\ {\isasymcdot}\ b{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasymsubseteq}\ M{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}carrier\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasyminter}\ M\ {\isacharequal}{\kern0pt}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}A{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ A{\isacharsemicolon}{\kern0pt}\ B{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ B{\isasymrbrakk}\ {\isasymLongrightarrow}\ smul\ A{\isacharprime}{\kern0pt}\ B{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}insert{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}NO{\isacharunderscore}{\kern0pt}MATCH\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ A\ {\isasymLongrightarrow}\ smul\ {\isacharparenleft}{\kern0pt}insert\ x\ A{\isacharparenright}{\kern0pt}\ B\ {\isacharequal}{\kern0pt}\ smul\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ B\ {\isasymunion}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}insert{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}NO{\isacharunderscore}{\kern0pt}MATCH\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ B\ {\isasymLongrightarrow}\ smul\ A\ {\isacharparenleft}{\kern0pt}insert\ x\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ smul\ A\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Un{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ A{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ B\ {\isacharequal}{\kern0pt}\ smul\ A\ B\ {\isasymunion}\ smul\ A{\isacharprime}{\kern0pt}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Un{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasymunion}\ B{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ smul\ A\ B\ {\isasymunion}\ smul\ A\ B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Union{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ A{\isacharparenright}{\kern0pt}\ B\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ a\ {\isasymin}\ A{\isachardot}{\kern0pt}\ smul\ a\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Union{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ b\ {\isasymin}\ B{\isachardot}{\kern0pt}\ smul\ A\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}insert{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasymsubseteq}\ smul\ A\ {\isacharparenleft}{\kern0pt}insert\ x\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasymsubseteq}\ smul\ {\isacharparenleft}{\kern0pt}insert\ x\ A{\isacharparenright}{\kern0pt}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Un{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasymsubseteq}\ smul\ A\ {\isacharparenleft}{\kern0pt}B{\isasymunion}C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ A\ B\ {\isasymsubseteq}\ smul\ {\isacharparenleft}{\kern0pt}A{\isasymunion}C{\isacharparenright}{\kern0pt}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}empty\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ A\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}empty{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasyminter}\ M\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}smul\ B\ A\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ A\ B\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ B\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymlongleftrightarrow}\ A\ {\isasyminter}\ M\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymor}\ B\ {\isasyminter}\ M\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}D\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ A\ {\isasyminter}\ M{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}\ A\ {\isacharequal}{\kern0pt}\ A\ {\isasyminter}\ M{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}carrier{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}smul\ A\ {\isacharparenleft}{\kern0pt}B\ {\isasyminter}\ M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ smul\ A\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}smul\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ M{\isacharparenright}{\kern0pt}\ B\ {\isacharequal}{\kern0pt}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}assoc{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}smul\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}\ C\ {\isacharequal}{\kern0pt}\ smul\ A\ {\isacharparenleft}{\kern0pt}smul\ B\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq\ associative\ Bex{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}smul{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}finite\ B{\isachardoublequoteclose}\ \ \isakeyword{shows}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}smul{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ M{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}B\ {\isasyminter}\ M{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{shows}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Exponentiation in a monoid: definitions and lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{primrec}\isamarkupfalse%
\ power\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infix}\ {\isachardoublequoteopen}{\isacharcircum}{\kern0pt}{\isachardoublequoteclose}\ {\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ power{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}power\ g\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ power{\isacharunderscore}{\kern0pt}suc{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}power\ g\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ power\ g\ n\ {\isasymcdot}\ g{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}power\ g\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}def\ power{\isadigit{0}}\ assms\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ n\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharcomma}{\kern0pt}\ auto\ simp\ add{\isacharcolon}{\kern0pt}\ assms\ power{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}mult{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n\ {\isacharplus}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ assms\ power{\isadigit{0}}\ right{\isacharunderscore}{\kern0pt}unit\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n\ {\isacharplus}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}right\ assms\ associative\ \isanewline
\ \ \ \ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ power{\isacharunderscore}{\kern0pt}suc{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ hind{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ local{\isachardot}{\kern0pt}inverse\ g\ {\isacharcircum}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ Suc\ n\ {\isasymcdot}\ inverse\ g\ {\isacharcircum}{\kern0pt}\ Suc\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}inverse\ g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}def\ power{\isacharunderscore}{\kern0pt}mult\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ add{\isachardot}{\kern0pt}commute\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ \isanewline
\ \ \ \ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse\ left{\isacharunderscore}{\kern0pt}unit\ monoid{\isachardot}{\kern0pt}associative\ monoid{\isacharunderscore}{\kern0pt}axioms\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ power{\isacharunderscore}{\kern0pt}suc{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ associative\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ assms\ hind\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ del{\isacharunderscore}{\kern0pt}insts{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ composition{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse\ right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ \isanewline
\ \ \ \ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}inverse\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}invertible\ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}inverse\ {\isacharparenleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ inverse{\isacharunderscore}{\kern0pt}equality\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power\ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}int\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ int\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}powi{\isachardoublequoteclose}\ {\isadigit{8}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}power{\isacharunderscore}{\kern0pt}int\ g\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ n\ {\isasymge}\ {\isadigit{0}}\ then\ g\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}nat\ n{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}nat\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ n{\isachardot}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ UNIV{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Union{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ n{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ powers\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}powers\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ n{\isachardot}{\kern0pt}\ g\ powi\ n{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ UNIV{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymsubseteq}\ powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ n\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}nat\ n\ {\isacharequal}{\kern0pt}\ n{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}def\ power{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UNIV{\isacharunderscore}{\kern0pt}I\ image{\isacharunderscore}{\kern0pt}iff\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ n\ \isakeyword{where}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hx\ power{\isadigit{0}}\ powers{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset\ rangeI\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ hpos{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ int\ n{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ g\ powi\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ int\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hx\ hpos\ power{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}powers\ g\ {\isacharequal}{\kern0pt}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymunion}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}powers\ g\ {\isasymsubseteq}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymunion}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}local{\isachardot}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}def\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ power{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymunion}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ powers\ g{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ inverse{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymone}\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ rangeI\ power{\isadigit{0}}\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ metis%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymsubseteq}\ M{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ assms\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymAnd}\ x\ y{\isachardot}{\kern0pt}\ x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymLongrightarrow}\ y\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymLongrightarrow}\ x\ {\isasymcdot}\ y\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ power{\isacharunderscore}{\kern0pt}mult\ assms\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mult{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymAnd}\ x\ y{\isachardot}{\kern0pt}\ x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymLongrightarrow}\ y\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ x\ {\isasymcdot}\ y\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ n\ m\ \isakeyword{where}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeyword{and}\ hy{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymcdot}\ y\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}n\ {\isasymge}\ m{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k\ \isakeyword{where}\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ k\ {\isacharplus}{\kern0pt}\ m{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ add{\isachardot}{\kern0pt}commute\ le{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}ex\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ k{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power\ assms\ associative\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ local{\isachardot}{\kern0pt}power{\isacharunderscore}{\kern0pt}mult\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hx\ hy\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ k\ \isakeyword{where}\ {\isachardoublequoteopen}m\ {\isacharequal}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ k{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ leI\ less{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}positive{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharcircum}{\kern0pt}\ n\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ k{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power\ assms\ associative\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}unit\ local{\isachardot}{\kern0pt}power{\isacharunderscore}{\kern0pt}mult\ monoid{\isachardot}{\kern0pt}invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ monoid{\isacharunderscore}{\kern0pt}axioms\ \isanewline
\ \ \ \ \ \ \ \ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hx\ hy\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymAnd}\ x\ y{\isachardot}{\kern0pt}\ x\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ y\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymLongrightarrow}\ x\ {\isasymcdot}\ y\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}inverse\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}invertible\isanewline
\ \ \ \ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mult\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ sup{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymAnd}\ x\ y{\isachardot}{\kern0pt}\ x\ {\isasymin}\ powers\ g\ {\isasymLongrightarrow}\ y\ {\isasymin}\ powers\ g\ {\isasymLongrightarrow}\ x\ {\isasymcdot}\ y\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ assms\ \isanewline
\ \ \ \ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mult\ inv{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}submonoid{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}submonoid\ {\isacharparenleft}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ M\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}locales{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ assms\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed\ one{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}monoid{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Group{\isacharunderscore}{\kern0pt}Theory{\isachardot}{\kern0pt}monoid\ {\isacharparenleft}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}submonoid\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ monoid{\isachardot}{\kern0pt}intro\ associative\ left{\isacharunderscore}{\kern0pt}unit\ \isanewline
\ \ \ \ \ \ one{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed\ right{\isacharunderscore}{\kern0pt}unit\ submonoid{\isachardot}{\kern0pt}sub{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}submonoid{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}submonoid\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ M\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}powers\ g\ {\isasymsubseteq}\ M{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}carrier\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ a\ {\isasymin}\ powers\ g\ {\isasymLongrightarrow}\ b\ {\isasymin}\ powers\ g\ {\isasymLongrightarrow}\ a\ {\isasymcdot}\ b\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymone}\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ one{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}monoid{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Group{\isacharunderscore}{\kern0pt}Theory{\isachardot}{\kern0pt}monoid\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ monoid{\isachardot}{\kern0pt}intro\ Un{\isacharunderscore}{\kern0pt}iff\ assms\ associative\ in{\isacharunderscore}{\kern0pt}mono\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ \isanewline
\ \ \ \ \ \ monoid{\isachardot}{\kern0pt}left{\isacharunderscore}{\kern0pt}unit\ monoid{\isachardot}{\kern0pt}right{\isacharunderscore}{\kern0pt}unit\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}monoid\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ \isanewline
\ \ \ \ \ \ powers{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}closed\ powers{\isacharunderscore}{\kern0pt}submonoid\ submonoid{\isachardot}{\kern0pt}sub{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}closed\ submonoid{\isachardot}{\kern0pt}subset{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}invertible{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}u\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}monoid{\isachardot}{\kern0pt}invertible\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ n\ \isakeyword{where}\ hu{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}u\ {\isacharequal}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}inverse\ u\ {\isasymin}\ powers\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}eq\ \isanewline
\ \ \ \ \ \ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ hu\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ in{\isacharunderscore}{\kern0pt}mono\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power\ inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}eq\ \isanewline
\ \ \ \ monoid{\isachardot}{\kern0pt}invertibleI\ monoid{\isachardot}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset\ monoid{\isachardot}{\kern0pt}powers{\isacharunderscore}{\kern0pt}monoid\ monoid{\isacharunderscore}{\kern0pt}axioms\ mult{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}invertible{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}u\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ {\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}monoid{\isachardot}{\kern0pt}invertible\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ inf{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}aci{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}inverse\ \isanewline
\ \ \ \ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}invertible\ mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}invertible\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}group{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}invertible\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Group{\isacharunderscore}{\kern0pt}Theory{\isachardot}{\kern0pt}group\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}u{\isachardot}{\kern0pt}\ u\ {\isasymin}\ powers\ g\ {\isasymLongrightarrow}\ monoid{\isachardot}{\kern0pt}invertible\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}\ u{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isanewline
\ \ \ \ mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}invertible\ mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}invertible\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ group{\isacharunderscore}{\kern0pt}def\ Group{\isacharunderscore}{\kern0pt}Theory{\isachardot}{\kern0pt}group{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}def\ assms\ powers{\isacharunderscore}{\kern0pt}monoid\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}g\ {\isasymnoteq}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}powers\ g\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isasymin}\ nat{\isacharunderscore}{\kern0pt}powers\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}one\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}def\ assms\ rangeI\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ M{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}g\ {\isasymnoteq}\ {\isasymone}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}powers\ g\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isasymone}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}one\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ all{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}conv\ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}subset\ one{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ subset{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\ group\isanewline
\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}subgroup{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}g\ {\isasymin}\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}subgroup\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ G\ {\isacharparenleft}{\kern0pt}{\isasymcdot}{\isacharparenright}{\kern0pt}\ {\isasymone}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ powers{\isacharunderscore}{\kern0pt}group\ powers{\isacharunderscore}{\kern0pt}submonoid\ subgroup{\isachardot}{\kern0pt}intro{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\ monoid\isanewline
\isanewline
\isakeyword{begin}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Definition of the order of an element in a monoid%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ order\ \isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}order\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}{\isasymexists}\ n{\isachardot}{\kern0pt}\ n\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ g\ {\isacharcircum}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ {\isasymone}{\isacharparenright}{\kern0pt}\ then\ Min\ {\isacharbraceleft}{\kern0pt}n{\isachardot}{\kern0pt}\ g\ {\isacharcircum}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ {\isasymone}\ {\isasymand}\ n\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharbraceright}{\kern0pt}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}order\ \isakeyword{where}\ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}order\ {\isacharequal}{\kern0pt}\ Min\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}order\ {\isacharbackquote}{\kern0pt}\ M{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Sumset scalar multiplication cardinality lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{context}\isamarkupfalse%
\ group\isanewline
\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}smul\ A\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isasymin}\ G\ then\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}a\ {\isasymin}\ G{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}smul\ A\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ x\ {\isasymcdot}\ a{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ x\ {\isasymcdot}\ a{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ True{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ True\ card{\isacharunderscore}{\kern0pt}image{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isasymin}\ G\ then\ card\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}a\ {\isasymin}\ G{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ a\ {\isasymcdot}\ x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ a\ {\isasymcdot}\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ True{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ True\ card{\isacharunderscore}{\kern0pt}image{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}sing{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}le{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}smul\ A\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ card{\isacharunderscore}{\kern0pt}mono\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}sing{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}le{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ card{\isacharunderscore}{\kern0pt}mono\ card{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ A{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}a\ {\isasymin}\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}a\ {\isasymin}\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ \ \ B{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}B\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}card\ B\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}B\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}inverse\ a{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ A\ B\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}clarsimp\ simp{\isacharcolon}{\kern0pt}\ smul\ image{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}\ Int{\isacharunderscore}{\kern0pt}iff\ invertible\ invertible{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ A\ B\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ \ finite{\isacharunderscore}{\kern0pt}smul\ surj{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ A{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isasymin}\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isasymin}\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ \ \ B{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ B{\isachardoublequoteclose}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}card\ A\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ x\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}inverse\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ A\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ A\ B\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}clarsimp\ simp{\isacharcolon}{\kern0pt}\ smul\ image{\isacharunderscore}{\kern0pt}iff\ associative{\isacharparenright}{\kern0pt}\ \ \ \ \ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}\ Int{\isacharunderscore}{\kern0pt}iff\ invertible\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse\ assms{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ A\ B\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ \ finite{\isacharunderscore}{\kern0pt}smul\ surj{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ infinite{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}A\ {\isasyminter}\ G\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}infinite\ {\isacharparenleft}{\kern0pt}B\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}infinite\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ hfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ a\ \isakeyword{where}\ ha{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ A\ {\isasyminter}\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hfin\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Int{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}eq{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ finite{\isacharunderscore}{\kern0pt}subset\ insert{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}Un\ \isanewline
\ \ \ \ mk{\isacharunderscore}{\kern0pt}disjoint{\isacharunderscore}{\kern0pt}insert\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Un{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}B\ {\isasyminter}\ G\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ inverse\ a\ {\isasymcdot}\ x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ B{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ b\ \isacommand{assume}\isamarkupfalse%
\ hb{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isasymin}\ B\ {\isasyminter}\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isacharequal}{\kern0pt}\ inverse\ a\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}a\ {\isasymcdot}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ associative\ ha\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ invertible{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ inverse\ a\ {\isasymcdot}\ x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ B{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ smul{\isachardot}{\kern0pt}simps\ hb\ ha\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}surj\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ infinite{\isacharunderscore}{\kern0pt}smul{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}B\ {\isasyminter}\ G\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}infinite\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}infinite\ {\isacharparenleft}{\kern0pt}A\ {\isasymcdots}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ hfin{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ b\ \isakeyword{where}\ hb{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isasymin}\ B\ {\isasyminter}\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}smul\ A\ {\isacharbraceleft}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hfin\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ rev{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}subset\ smul{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}A\ {\isasyminter}\ G\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ x\ {\isasymcdot}\ inverse\ b{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ A\ {\isacharbraceleft}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ a\ \isacommand{assume}\isamarkupfalse%
\ ha{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ A\ {\isasyminter}\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ {\isasymcdot}\ b{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ inverse\ b{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ associative\ hb\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ IntD{\isadigit{2}}\ invertible\ invertible{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}closed\ invertible{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}inverse\ right{\isacharunderscore}{\kern0pt}unit{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ x{\isachardot}{\kern0pt}\ x\ {\isasymcdot}\ inverse\ b{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ smul\ A\ {\isacharbraceleft}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ smul{\isachardot}{\kern0pt}simps\ hb\ ha\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}surj\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Pointwise set multiplication in a group: auxiliary lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}composition{\isacharunderscore}{\kern0pt}commute{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}Y\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ y\ \isakeyword{where}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ inverse\ {\isacharparenleft}{\kern0pt}x\ {\isasymcdot}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isasymin}\ Y{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}iff\ smul{\isachardot}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}composition{\isacharunderscore}{\kern0pt}commute\ assms\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}eqI\ in{\isacharunderscore}{\kern0pt}mono\ inverse{\isacharunderscore}{\kern0pt}equality\ invertible\ invertibleE\ smul{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ Y{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}inverse\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ y\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isasymin}\ Y{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ inverse\ y\ {\isasymcdot}\ inverse\ x{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ smul{\isachardot}{\kern0pt}cases\ image{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ inverse\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ Y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}composition{\isacharunderscore}{\kern0pt}commute\ assms\ smul{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}iff\ in{\isacharunderscore}{\kern0pt}mono\ invertible{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}g\ {\isasymin}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}def\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ hXn{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharbraceright}{\kern0pt}\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ {\isacharparenleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ \ \isacommand{using}\isamarkupfalse%
\ smul{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ associative\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}mono\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hx\ assms\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ smul{\isachardot}{\kern0pt}smulI\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isasymsubseteq}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ \isakeyword{where}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymcdot}\ g{\isachardoublequoteclose}\ \isakeyword{and}\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ smul{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}def\ associative\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g\ {\isacharcircum}{\kern0pt}\ Suc\ n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hx\ assms\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ power{\isacharunderscore}{\kern0pt}mem{\isacharunderscore}{\kern0pt}carrier\ smul{\isachardot}{\kern0pt}smulI\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}g\ {\isasymin}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}inverse\ g{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}\ {\isasymsubseteq}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ y\ x\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isasymin}\ X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ y\ {\isasymcdot}\ inverse\ g{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\ \ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ g{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ smul{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ empty{\isacharunderscore}{\kern0pt}iff\ insert{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isasymin}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ associative\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ hx{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ X{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ x\ {\isasymcdot}\ g\ {\isasymcdot}\ inverse\ g{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ associative\ subset{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ smul{\isachardot}{\kern0pt}simps\ hx\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}inverse\ g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}powers{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}X\ {\isasymsubseteq}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}g\ {\isasymin}\ G{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharbraceleft}{\kern0pt}g{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}X\ {\isasymcdots}\ {\isacharparenleft}{\kern0pt}powers\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ X{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Union{\isadigit{2}}\ \isanewline
\ \ \ \ nat{\isacharunderscore}{\kern0pt}powers{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Union\ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ \isanewline
\ \ \ \ smul{\isacharunderscore}{\kern0pt}singleton{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}contains{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}powers\ assms\ smul{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Un{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{$ecard$ -- extended definition of cardinality of a set%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
$ecard$ -- definition of a cardinality of a set taking values in $enat$ -- extended natural numbers, defined to be $\infty$ for infinite sets%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ ecard\ \isakeyword{where}\ {\isachardoublequoteopen}ecard\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ finite\ A\ then\ card\ A\ else\ {\isasyminfinity}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ ecard{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}finite{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}ecard\ A\ {\isacharequal}{\kern0pt}\ card\ A{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ ecard{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ metis%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\ monoid\isanewline
\isakeyword{begin}%
\begin{isamarkuptext}%
$orderOf$ -- abbreviation for the order of a monoid%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{abbreviation}\isamarkupfalse%
\ orderOf\ \isakeyword{where}\ {\isachardoublequoteopen}orderOf\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}\ ecard{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/IsabelleProjects/Generalized_Cauchy_Davenport/Generalized_Cauchy_Davenport_preliminaries.thy%:%
%:%11=1%:%
%:%27=14%:%
%:%28=14%:%
%:%29=15%:%
%:%30=16%:%
%:%31=17%:%
%:%32=18%:%
%:%33=19%:%
%:%34=20%:%
%:%48=22%:%
%:%58=24%:%
%:%59=24%:%
%:%60=25%:%
%:%61=26%:%
%:%62=27%:%
%:%63=28%:%
%:%64=29%:%
%:%65=30%:%
%:%72=31%:%
%:%73=31%:%
%:%74=32%:%
%:%75=32%:%
%:%76=33%:%
%:%77=33%:%
%:%78=34%:%
%:%79=34%:%
%:%80=35%:%
%:%81=36%:%
%:%82=36%:%
%:%83=37%:%
%:%84=37%:%
%:%85=38%:%
%:%86=39%:%
%:%87=39%:%
%:%88=40%:%
%:%89=40%:%
%:%90=40%:%
%:%91=41%:%
%:%92=41%:%
%:%93=41%:%
%:%94=42%:%
%:%95=42%:%
%:%96=42%:%
%:%97=43%:%
%:%98=43%:%
%:%99=43%:%
%:%100=44%:%
%:%101=44%:%
%:%102=44%:%
%:%103=45%:%
%:%104=45%:%
%:%105=46%:%
%:%106=46%:%
%:%107=47%:%
%:%108=47%:%
%:%109=48%:%
%:%110=48%:%
%:%111=49%:%
%:%112=49%:%
%:%113=50%:%
%:%114=50%:%
%:%115=50%:%
%:%116=51%:%
%:%117=52%:%
%:%118=52%:%
%:%119=52%:%
%:%120=53%:%
%:%121=53%:%
%:%122=53%:%
%:%123=54%:%
%:%124=54%:%
%:%125=55%:%
%:%126=55%:%
%:%127=56%:%
%:%128=56%:%
%:%129=56%:%
%:%130=57%:%
%:%131=57%:%
%:%132=57%:%
%:%133=58%:%
%:%139=58%:%
%:%142=59%:%
%:%143=60%:%
%:%144=60%:%
%:%145=61%:%
%:%146=62%:%
%:%147=63%:%
%:%148=64%:%
%:%151=65%:%
%:%155=65%:%
%:%156=65%:%
%:%157=66%:%
%:%158=66%:%
%:%163=66%:%
%:%166=67%:%
%:%167=68%:%
%:%168=68%:%
%:%169=69%:%
%:%170=70%:%
%:%177=72%:%
%:%187=74%:%
%:%188=74%:%
%:%189=75%:%
%:%190=76%:%
%:%191=77%:%
%:%192=78%:%
%:%193=78%:%
%:%194=79%:%
%:%195=80%:%
%:%196=80%:%
%:%199=81%:%
%:%203=81%:%
%:%204=81%:%
%:%209=81%:%
%:%212=82%:%
%:%213=83%:%
%:%214=83%:%
%:%217=84%:%
%:%221=84%:%
%:%222=84%:%
%:%227=84%:%
%:%230=85%:%
%:%231=86%:%
%:%232=86%:%
%:%235=87%:%
%:%239=87%:%
%:%240=87%:%
%:%245=87%:%
%:%248=88%:%
%:%249=89%:%
%:%250=89%:%
%:%253=90%:%
%:%257=90%:%
%:%258=90%:%
%:%263=90%:%
%:%266=91%:%
%:%267=92%:%
%:%268=92%:%
%:%271=93%:%
%:%275=93%:%
%:%276=93%:%
%:%281=93%:%
%:%284=94%:%
%:%285=95%:%
%:%286=95%:%
%:%289=96%:%
%:%293=96%:%
%:%294=96%:%
%:%299=96%:%
%:%302=97%:%
%:%303=98%:%
%:%304=98%:%
%:%307=99%:%
%:%311=99%:%
%:%312=99%:%
%:%317=99%:%
%:%320=100%:%
%:%321=101%:%
%:%322=101%:%
%:%325=102%:%
%:%329=102%:%
%:%330=102%:%
%:%335=102%:%
%:%338=103%:%
%:%339=104%:%
%:%340=104%:%
%:%343=105%:%
%:%347=105%:%
%:%348=105%:%
%:%353=105%:%
%:%356=106%:%
%:%357=107%:%
%:%358=107%:%
%:%361=108%:%
%:%365=108%:%
%:%366=108%:%
%:%371=108%:%
%:%374=109%:%
%:%375=110%:%
%:%376=110%:%
%:%379=111%:%
%:%383=111%:%
%:%384=111%:%
%:%389=111%:%
%:%392=112%:%
%:%393=113%:%
%:%394=113%:%
%:%397=114%:%
%:%401=114%:%
%:%402=114%:%
%:%407=114%:%
%:%410=115%:%
%:%411=116%:%
%:%412=116%:%
%:%415=117%:%
%:%419=117%:%
%:%420=117%:%
%:%425=117%:%
%:%428=118%:%
%:%429=119%:%
%:%430=119%:%
%:%433=120%:%
%:%437=120%:%
%:%438=120%:%
%:%443=120%:%
%:%446=121%:%
%:%447=122%:%
%:%448=122%:%
%:%449=123%:%
%:%450=124%:%
%:%453=125%:%
%:%457=125%:%
%:%458=125%:%
%:%459=125%:%
%:%464=125%:%
%:%467=126%:%
%:%468=127%:%
%:%469=127%:%
%:%472=128%:%
%:%476=128%:%
%:%477=128%:%
%:%482=128%:%
%:%485=129%:%
%:%486=130%:%
%:%487=130%:%
%:%490=131%:%
%:%494=131%:%
%:%495=131%:%
%:%500=131%:%
%:%503=132%:%
%:%504=133%:%
%:%505=133%:%
%:%508=134%:%
%:%512=134%:%
%:%513=134%:%
%:%518=134%:%
%:%521=135%:%
%:%522=136%:%
%:%523=136%:%
%:%524=137%:%
%:%527=138%:%
%:%531=138%:%
%:%532=138%:%
%:%537=138%:%
%:%540=139%:%
%:%541=140%:%
%:%542=140%:%
%:%543=141%:%
%:%546=142%:%
%:%550=142%:%
%:%551=142%:%
%:%552=142%:%
%:%557=142%:%
%:%560=143%:%
%:%561=144%:%
%:%562=144%:%
%:%563=145%:%
%:%564=146%:%
%:%567=147%:%
%:%571=147%:%
%:%572=147%:%
%:%573=147%:%
%:%587=149%:%
%:%597=150%:%
%:%598=150%:%
%:%599=151%:%
%:%600=152%:%
%:%601=153%:%
%:%602=154%:%
%:%603=155%:%
%:%604=155%:%
%:%605=156%:%
%:%606=157%:%
%:%608=157%:%
%:%612=157%:%
%:%613=157%:%
%:%614=157%:%
%:%621=157%:%
%:%622=158%:%
%:%623=159%:%
%:%624=159%:%
%:%625=160%:%
%:%626=161%:%
%:%627=162%:%
%:%630=163%:%
%:%634=163%:%
%:%635=163%:%
%:%636=164%:%
%:%642=164%:%
%:%645=165%:%
%:%646=166%:%
%:%647=166%:%
%:%648=167%:%
%:%649=168%:%
%:%656=169%:%
%:%657=169%:%
%:%658=170%:%
%:%659=170%:%
%:%660=171%:%
%:%661=171%:%
%:%662=171%:%
%:%663=171%:%
%:%664=171%:%
%:%665=172%:%
%:%666=172%:%
%:%667=173%:%
%:%668=173%:%
%:%669=174%:%
%:%670=174%:%
%:%671=175%:%
%:%672=175%:%
%:%673=175%:%
%:%674=175%:%
%:%675=175%:%
%:%676=176%:%
%:%677=177%:%
%:%683=177%:%
%:%686=178%:%
%:%687=179%:%
%:%688=179%:%
%:%689=180%:%
%:%690=181%:%
%:%697=182%:%
%:%698=182%:%
%:%699=183%:%
%:%700=183%:%
%:%701=184%:%
%:%702=184%:%
%:%703=184%:%
%:%704=184%:%
%:%705=184%:%
%:%706=185%:%
%:%707=185%:%
%:%708=186%:%
%:%709=186%:%
%:%710=187%:%
%:%711=187%:%
%:%712=188%:%
%:%713=188%:%
%:%714=188%:%
%:%715=189%:%
%:%716=189%:%
%:%717=189%:%
%:%718=190%:%
%:%719=191%:%
%:%720=191%:%
%:%721=191%:%
%:%722=191%:%
%:%723=191%:%
%:%724=192%:%
%:%725=193%:%
%:%731=193%:%
%:%734=194%:%
%:%735=195%:%
%:%736=195%:%
%:%737=196%:%
%:%738=197%:%
%:%740=197%:%
%:%744=197%:%
%:%745=197%:%
%:%746=197%:%
%:%747=198%:%
%:%754=198%:%
%:%755=199%:%
%:%756=200%:%
%:%757=200%:%
%:%758=201%:%
%:%759=202%:%
%:%762=203%:%
%:%766=203%:%
%:%767=203%:%
%:%768=203%:%
%:%773=203%:%
%:%776=204%:%
%:%777=205%:%
%:%778=205%:%
%:%779=206%:%
%:%780=207%:%
%:%781=208%:%
%:%782=208%:%
%:%783=209%:%
%:%784=210%:%
%:%785=210%:%
%:%787=210%:%
%:%791=210%:%
%:%792=210%:%
%:%793=210%:%
%:%800=210%:%
%:%801=211%:%
%:%802=212%:%
%:%803=212%:%
%:%804=213%:%
%:%805=214%:%
%:%806=214%:%
%:%807=215%:%
%:%814=216%:%
%:%815=216%:%
%:%816=217%:%
%:%817=217%:%
%:%818=217%:%
%:%819=218%:%
%:%820=218%:%
%:%821=218%:%
%:%822=218%:%
%:%823=218%:%
%:%824=219%:%
%:%825=219%:%
%:%826=219%:%
%:%827=219%:%
%:%828=220%:%
%:%829=220%:%
%:%830=221%:%
%:%836=221%:%
%:%839=222%:%
%:%840=223%:%
%:%841=223%:%
%:%842=224%:%
%:%849=225%:%
%:%850=225%:%
%:%851=226%:%
%:%852=226%:%
%:%853=226%:%
%:%854=227%:%
%:%855=227%:%
%:%856=227%:%
%:%857=227%:%
%:%858=227%:%
%:%859=228%:%
%:%860=228%:%
%:%861=228%:%
%:%862=229%:%
%:%863=229%:%
%:%864=230%:%
%:%865=230%:%
%:%866=231%:%
%:%867=231%:%
%:%868=231%:%
%:%869=231%:%
%:%870=232%:%
%:%871=232%:%
%:%872=233%:%
%:%873=233%:%
%:%874=234%:%
%:%875=234%:%
%:%876=235%:%
%:%877=235%:%
%:%878=235%:%
%:%879=235%:%
%:%880=236%:%
%:%881=236%:%
%:%882=236%:%
%:%883=236%:%
%:%884=236%:%
%:%885=237%:%
%:%886=237%:%
%:%887=237%:%
%:%888=237%:%
%:%889=237%:%
%:%890=238%:%
%:%891=238%:%
%:%892=239%:%
%:%898=239%:%
%:%901=240%:%
%:%902=241%:%
%:%903=241%:%
%:%904=242%:%
%:%911=243%:%
%:%912=243%:%
%:%913=244%:%
%:%914=244%:%
%:%915=245%:%
%:%916=245%:%
%:%917=245%:%
%:%918=246%:%
%:%919=246%:%
%:%920=247%:%
%:%921=247%:%
%:%922=248%:%
%:%923=248%:%
%:%924=249%:%
%:%930=249%:%
%:%933=250%:%
%:%934=251%:%
%:%935=251%:%
%:%938=252%:%
%:%942=252%:%
%:%943=252%:%
%:%944=252%:%
%:%949=252%:%
%:%952=253%:%
%:%953=254%:%
%:%954=254%:%
%:%955=255%:%
%:%956=256%:%
%:%959=257%:%
%:%963=257%:%
%:%964=257%:%
%:%965=257%:%
%:%970=257%:%
%:%973=258%:%
%:%974=259%:%
%:%975=259%:%
%:%976=260%:%
%:%977=261%:%
%:%980=262%:%
%:%984=262%:%
%:%985=262%:%
%:%986=262%:%
%:%991=262%:%
%:%994=263%:%
%:%995=264%:%
%:%996=264%:%
%:%997=265%:%
%:%998=266%:%
%:%1005=267%:%
%:%1006=267%:%
%:%1007=268%:%
%:%1008=268%:%
%:%1009=268%:%
%:%1010=269%:%
%:%1011=269%:%
%:%1012=269%:%
%:%1013=269%:%
%:%1014=269%:%
%:%1015=270%:%
%:%1016=270%:%
%:%1017=271%:%
%:%1018=271%:%
%:%1019=272%:%
%:%1020=272%:%
%:%1021=273%:%
%:%1022=273%:%
%:%1023=273%:%
%:%1024=273%:%
%:%1025=273%:%
%:%1026=274%:%
%:%1027=274%:%
%:%1028=274%:%
%:%1029=274%:%
%:%1030=275%:%
%:%1031=275%:%
%:%1032=276%:%
%:%1033=276%:%
%:%1034=276%:%
%:%1035=276%:%
%:%1036=276%:%
%:%1037=277%:%
%:%1038=277%:%
%:%1039=278%:%
%:%1040=278%:%
%:%1041=279%:%
%:%1042=279%:%
%:%1043=279%:%
%:%1044=279%:%
%:%1045=280%:%
%:%1046=280%:%
%:%1047=280%:%
%:%1048=280%:%
%:%1049=281%:%
%:%1050=281%:%
%:%1051=282%:%
%:%1052=283%:%
%:%1053=283%:%
%:%1054=283%:%
%:%1055=283%:%
%:%1056=283%:%
%:%1057=284%:%
%:%1058=284%:%
%:%1059=285%:%
%:%1065=285%:%
%:%1068=286%:%
%:%1069=287%:%
%:%1070=287%:%
%:%1071=288%:%
%:%1072=289%:%
%:%1075=290%:%
%:%1079=290%:%
%:%1080=290%:%
%:%1081=291%:%
%:%1086=291%:%
%:%1089=292%:%
%:%1090=293%:%
%:%1091=293%:%
%:%1092=294%:%
%:%1093=295%:%
%:%1096=296%:%
%:%1100=296%:%
%:%1101=296%:%
%:%1102=297%:%
%:%1103=297%:%
%:%1108=297%:%
%:%1111=298%:%
%:%1112=299%:%
%:%1113=299%:%
%:%1114=300%:%
%:%1115=301%:%
%:%1118=302%:%
%:%1122=302%:%
%:%1123=302%:%
%:%1124=303%:%
%:%1125=303%:%
%:%1126=304%:%
%:%1132=304%:%
%:%1135=305%:%
%:%1136=306%:%
%:%1137=306%:%
%:%1138=307%:%
%:%1139=308%:%
%:%1142=309%:%
%:%1146=309%:%
%:%1147=309%:%
%:%1148=309%:%
%:%1149=310%:%
%:%1154=310%:%
%:%1157=311%:%
%:%1158=312%:%
%:%1159=312%:%
%:%1160=313%:%
%:%1161=314%:%
%:%1168=315%:%
%:%1169=315%:%
%:%1170=316%:%
%:%1171=316%:%
%:%1172=316%:%
%:%1173=316%:%
%:%1174=317%:%
%:%1175=317%:%
%:%1176=318%:%
%:%1177=318%:%
%:%1178=319%:%
%:%1179=319%:%
%:%1180=319%:%
%:%1181=320%:%
%:%1182=320%:%
%:%1183=321%:%
%:%1184=321%:%
%:%1185=321%:%
%:%1186=321%:%
%:%1187=322%:%
%:%1193=322%:%
%:%1196=323%:%
%:%1197=324%:%
%:%1198=324%:%
%:%1199=325%:%
%:%1200=326%:%
%:%1203=327%:%
%:%1207=327%:%
%:%1208=327%:%
%:%1209=328%:%
%:%1210=329%:%
%:%1215=329%:%
%:%1218=330%:%
%:%1219=331%:%
%:%1220=331%:%
%:%1221=332%:%
%:%1222=333%:%
%:%1229=334%:%
%:%1230=334%:%
%:%1231=335%:%
%:%1232=335%:%
%:%1233=335%:%
%:%1234=335%:%
%:%1235=336%:%
%:%1236=336%:%
%:%1237=336%:%
%:%1238=336%:%
%:%1239=337%:%
%:%1240=337%:%
%:%1241=338%:%
%:%1242=338%:%
%:%1243=338%:%
%:%1244=338%:%
%:%1245=338%:%
%:%1246=339%:%
%:%1247=340%:%
%:%1253=340%:%
%:%1256=341%:%
%:%1257=342%:%
%:%1258=342%:%
%:%1259=343%:%
%:%1260=344%:%
%:%1263=345%:%
%:%1267=345%:%
%:%1268=345%:%
%:%1269=345%:%
%:%1270=346%:%
%:%1275=346%:%
%:%1278=347%:%
%:%1279=348%:%
%:%1280=348%:%
%:%1281=349%:%
%:%1282=350%:%
%:%1289=351%:%
%:%1290=351%:%
%:%1291=352%:%
%:%1292=352%:%
%:%1293=352%:%
%:%1294=353%:%
%:%1295=353%:%
%:%1296=354%:%
%:%1297=354%:%
%:%1298=354%:%
%:%1299=354%:%
%:%1300=354%:%
%:%1301=355%:%
%:%1307=355%:%
%:%1310=356%:%
%:%1311=357%:%
%:%1312=357%:%
%:%1313=358%:%
%:%1314=359%:%
%:%1321=360%:%
%:%1322=360%:%
%:%1323=361%:%
%:%1324=361%:%
%:%1325=361%:%
%:%1326=361%:%
%:%1327=362%:%
%:%1328=362%:%
%:%1329=362%:%
%:%1330=362%:%
%:%1331=362%:%
%:%1332=363%:%
%:%1338=363%:%
%:%1341=364%:%
%:%1342=365%:%
%:%1343=365%:%
%:%1344=366%:%
%:%1345=367%:%
%:%1347=367%:%
%:%1351=367%:%
%:%1352=367%:%
%:%1353=368%:%
%:%1354=368%:%
%:%1361=368%:%
%:%1362=369%:%
%:%1363=370%:%
%:%1364=370%:%
%:%1365=371%:%
%:%1366=372%:%
%:%1367=372%:%
%:%1368=373%:%
%:%1369=374%:%
%:%1370=375%:%
%:%1371=376%:%
%:%1372=376%:%
%:%1373=377%:%
%:%1374=378%:%
%:%1377=379%:%
%:%1381=379%:%
%:%1382=379%:%
%:%1387=379%:%
%:%1390=380%:%
%:%1391=381%:%
%:%1392=381%:%
%:%1393=382%:%
%:%1394=383%:%
%:%1395=383%:%
%:%1396=384%:%
%:%1397=385%:%
%:%1404=387%:%
%:%1414=388%:%
%:%1415=388%:%
%:%1416=389%:%
%:%1417=390%:%
%:%1418=391%:%
%:%1419=391%:%
%:%1420=392%:%
%:%1421=393%:%
%:%1429=395%:%
%:%1439=396%:%
%:%1440=396%:%
%:%1441=397%:%
%:%1442=398%:%
%:%1443=399%:%
%:%1444=400%:%
%:%1445=400%:%
%:%1446=401%:%
%:%1453=402%:%
%:%1454=402%:%
%:%1455=403%:%
%:%1456=403%:%
%:%1457=404%:%
%:%1458=404%:%
%:%1459=404%:%
%:%1460=405%:%
%:%1461=405%:%
%:%1462=406%:%
%:%1463=406%:%
%:%1464=406%:%
%:%1465=407%:%
%:%1466=407%:%
%:%1467=408%:%
%:%1468=408%:%
%:%1469=408%:%
%:%1470=409%:%
%:%1471=409%:%
%:%1472=410%:%
%:%1473=410%:%
%:%1478=410%:%
%:%1481=411%:%
%:%1482=412%:%
%:%1483=412%:%
%:%1484=413%:%
%:%1491=414%:%
%:%1492=414%:%
%:%1493=415%:%
%:%1494=415%:%
%:%1495=416%:%
%:%1496=416%:%
%:%1497=416%:%
%:%1498=417%:%
%:%1499=417%:%
%:%1500=418%:%
%:%1501=418%:%
%:%1502=418%:%
%:%1503=419%:%
%:%1504=419%:%
%:%1505=420%:%
%:%1506=420%:%
%:%1507=420%:%
%:%1508=421%:%
%:%1509=421%:%
%:%1510=422%:%
%:%1511=422%:%
%:%1516=422%:%
%:%1519=423%:%
%:%1520=424%:%
%:%1521=424%:%
%:%1522=425%:%
%:%1525=426%:%
%:%1529=426%:%
%:%1530=426%:%
%:%1535=426%:%
%:%1538=427%:%
%:%1539=428%:%
%:%1540=428%:%
%:%1541=429%:%
%:%1544=430%:%
%:%1548=430%:%
%:%1549=430%:%
%:%1554=430%:%
%:%1557=431%:%
%:%1558=432%:%
%:%1559=432%:%
%:%1560=433%:%
%:%1561=434%:%
%:%1562=435%:%
%:%1569=436%:%
%:%1570=436%:%
%:%1571=437%:%
%:%1572=437%:%
%:%1573=438%:%
%:%1574=438%:%
%:%1575=439%:%
%:%1576=439%:%
%:%1577=440%:%
%:%1578=440%:%
%:%1579=440%:%
%:%1580=441%:%
%:%1581=441%:%
%:%1582=441%:%
%:%1583=442%:%
%:%1584=442%:%
%:%1585=443%:%
%:%1591=443%:%
%:%1594=444%:%
%:%1595=445%:%
%:%1596=445%:%
%:%1597=446%:%
%:%1598=447%:%
%:%1599=448%:%
%:%1606=449%:%
%:%1607=449%:%
%:%1608=450%:%
%:%1609=450%:%
%:%1610=451%:%
%:%1611=451%:%
%:%1612=452%:%
%:%1613=452%:%
%:%1614=453%:%
%:%1615=453%:%
%:%1616=453%:%
%:%1617=454%:%
%:%1618=454%:%
%:%1619=454%:%
%:%1620=455%:%
%:%1621=455%:%
%:%1622=456%:%
%:%1628=456%:%
%:%1631=457%:%
%:%1632=458%:%
%:%1633=459%:%
%:%1634=459%:%
%:%1635=460%:%
%:%1636=461%:%
%:%1643=462%:%
%:%1644=462%:%
%:%1645=463%:%
%:%1646=463%:%
%:%1647=464%:%
%:%1648=464%:%
%:%1649=464%:%
%:%1650=464%:%
%:%1651=465%:%
%:%1652=465%:%
%:%1653=465%:%
%:%1654=465%:%
%:%1655=465%:%
%:%1656=466%:%
%:%1657=467%:%
%:%1658=467%:%
%:%1659=467%:%
%:%1660=468%:%
%:%1661=468%:%
%:%1662=469%:%
%:%1663=469%:%
%:%1664=469%:%
%:%1665=470%:%
%:%1666=470%:%
%:%1667=470%:%
%:%1668=470%:%
%:%1669=470%:%
%:%1670=471%:%
%:%1671=471%:%
%:%1672=471%:%
%:%1673=471%:%
%:%1674=471%:%
%:%1675=472%:%
%:%1676=472%:%
%:%1677=473%:%
%:%1678=473%:%
%:%1679=473%:%
%:%1680=473%:%
%:%1681=473%:%
%:%1682=473%:%
%:%1683=474%:%
%:%1689=474%:%
%:%1692=475%:%
%:%1693=476%:%
%:%1694=476%:%
%:%1695=477%:%
%:%1696=478%:%
%:%1703=479%:%
%:%1704=479%:%
%:%1705=480%:%
%:%1706=480%:%
%:%1707=481%:%
%:%1708=481%:%
%:%1709=481%:%
%:%1710=481%:%
%:%1711=482%:%
%:%1712=482%:%
%:%1713=482%:%
%:%1714=482%:%
%:%1715=482%:%
%:%1716=483%:%
%:%1717=483%:%
%:%1718=483%:%
%:%1719=484%:%
%:%1720=484%:%
%:%1721=485%:%
%:%1722=485%:%
%:%1723=485%:%
%:%1724=486%:%
%:%1725=486%:%
%:%1726=486%:%
%:%1727=486%:%
%:%1728=487%:%
%:%1729=487%:%
%:%1730=488%:%
%:%1731=488%:%
%:%1732=488%:%
%:%1733=488%:%
%:%1734=488%:%
%:%1735=489%:%
%:%1736=489%:%
%:%1737=490%:%
%:%1738=490%:%
%:%1739=490%:%
%:%1740=490%:%
%:%1741=490%:%
%:%1742=490%:%
%:%1743=491%:%
%:%1758=493%:%
%:%1768=494%:%
%:%1769=494%:%
%:%1770=495%:%
%:%1771=496%:%
%:%1778=497%:%
%:%1779=497%:%
%:%1780=498%:%
%:%1781=498%:%
%:%1782=499%:%
%:%1783=499%:%
%:%1784=500%:%
%:%1785=500%:%
%:%1786=500%:%
%:%1787=501%:%
%:%1788=501%:%
%:%1789=501%:%
%:%1790=502%:%
%:%1791=502%:%
%:%1792=503%:%
%:%1793=503%:%
%:%1794=503%:%
%:%1795=504%:%
%:%1796=504%:%
%:%1797=505%:%
%:%1798=505%:%
%:%1799=506%:%
%:%1800=506%:%
%:%1801=507%:%
%:%1802=507%:%
%:%1803=508%:%
%:%1804=508%:%
%:%1805=509%:%
%:%1806=509%:%
%:%1807=509%:%
%:%1808=510%:%
%:%1809=510%:%
%:%1810=510%:%
%:%1811=511%:%
%:%1812=511%:%
%:%1813=511%:%
%:%1814=512%:%
%:%1815=512%:%
%:%1816=512%:%
%:%1817=512%:%
%:%1818=513%:%
%:%1819=513%:%
%:%1820=514%:%
%:%1821=514%:%
%:%1822=515%:%
%:%1828=515%:%
%:%1831=516%:%
%:%1832=517%:%
%:%1833=517%:%
%:%1834=518%:%
%:%1835=519%:%
%:%1836=520%:%
%:%1843=521%:%
%:%1844=521%:%
%:%1845=522%:%
%:%1846=522%:%
%:%1847=523%:%
%:%1848=523%:%
%:%1849=523%:%
%:%1850=523%:%
%:%1851=523%:%
%:%1852=524%:%
%:%1853=524%:%
%:%1854=525%:%
%:%1855=525%:%
%:%1856=526%:%
%:%1857=526%:%
%:%1858=527%:%
%:%1859=527%:%
%:%1860=527%:%
%:%1861=528%:%
%:%1862=528%:%
%:%1863=529%:%
%:%1864=529%:%
%:%1865=530%:%
%:%1866=530%:%
%:%1867=531%:%
%:%1868=531%:%
%:%1869=531%:%
%:%1870=532%:%
%:%1871=532%:%
%:%1872=532%:%
%:%1873=532%:%
%:%1874=532%:%
%:%1875=533%:%
%:%1876=533%:%
%:%1877=533%:%
%:%1878=533%:%
%:%1879=533%:%
%:%1880=534%:%
%:%1881=534%:%
%:%1882=534%:%
%:%1883=534%:%
%:%1884=535%:%
%:%1885=535%:%
%:%1886=536%:%
%:%1887=536%:%
%:%1888=537%:%
%:%1889=537%:%
%:%1890=538%:%
%:%1891=538%:%
%:%1892=539%:%
%:%1893=539%:%
%:%1894=540%:%
%:%1895=540%:%
%:%1896=540%:%
%:%1897=541%:%
%:%1898=541%:%
%:%1899=541%:%
%:%1900=541%:%
%:%1901=541%:%
%:%1902=542%:%
%:%1903=542%:%
%:%1904=542%:%
%:%1905=543%:%
%:%1906=543%:%
%:%1907=543%:%
%:%1908=544%:%
%:%1909=544%:%
%:%1910=544%:%
%:%1911=544%:%
%:%1912=545%:%
%:%1913=545%:%
%:%1914=546%:%
%:%1915=546%:%
%:%1916=547%:%
%:%1917=547%:%
%:%1918=548%:%
%:%1919=548%:%
%:%1920=548%:%
%:%1921=548%:%
%:%1922=548%:%
%:%1923=549%:%
%:%1929=549%:%
%:%1932=550%:%
%:%1933=551%:%
%:%1934=551%:%
%:%1935=552%:%
%:%1936=553%:%
%:%1937=554%:%
%:%1944=555%:%
%:%1945=555%:%
%:%1946=556%:%
%:%1947=556%:%
%:%1948=557%:%
%:%1949=557%:%
%:%1950=558%:%
%:%1951=558%:%
%:%1952=559%:%
%:%1953=559%:%
%:%1954=560%:%
%:%1955=560%:%
%:%1956=560%:%
%:%1957=561%:%
%:%1958=561%:%
%:%1959=561%:%
%:%1960=562%:%
%:%1961=562%:%
%:%1962=562%:%
%:%1963=563%:%
%:%1964=563%:%
%:%1965=563%:%
%:%1966=563%:%
%:%1967=563%:%
%:%1968=564%:%
%:%1969=564%:%
%:%1970=565%:%
%:%1971=565%:%
%:%1972=566%:%
%:%1973=566%:%
%:%1974=567%:%
%:%1975=567%:%
%:%1976=568%:%
%:%1977=568%:%
%:%1978=568%:%
%:%1979=569%:%
%:%1980=569%:%
%:%1981=569%:%
%:%1982=569%:%
%:%1983=569%:%
%:%1984=570%:%
%:%1985=570%:%
%:%1986=570%:%
%:%1987=570%:%
%:%1988=570%:%
%:%1989=571%:%
%:%1990=571%:%
%:%1991=572%:%
%:%1992=572%:%
%:%1993=573%:%
%:%1994=573%:%
%:%1995=573%:%
%:%1996=573%:%
%:%1997=573%:%
%:%1998=574%:%
%:%1999=574%:%
%:%2000=574%:%
%:%2001=574%:%
%:%2002=574%:%
%:%2003=575%:%
%:%2009=575%:%
%:%2012=576%:%
%:%2013=577%:%
%:%2014=577%:%
%:%2015=578%:%
%:%2016=579%:%
%:%2017=580%:%
%:%2019=580%:%
%:%2023=580%:%
%:%2024=580%:%
%:%2025=581%:%
%:%2026=582%:%
%:%2027=582%:%
%:%2034=582%:%
%:%2035=583%:%
%:%2036=584%:%
%:%2044=586%:%
%:%2056=588%:%
%:%2058=589%:%
%:%2059=589%:%
%:%2060=590%:%
%:%2061=591%:%
%:%2062=591%:%
%:%2063=592%:%
%:%2064=593%:%
%:%2067=594%:%
%:%2071=594%:%
%:%2072=594%:%
%:%2073=594%:%
%:%2078=594%:%
%:%2081=595%:%
%:%2082=596%:%
%:%2083=597%:%
%:%2084=597%:%
%:%2085=598%:%
%:%2087=600%:%
%:%2089=601%:%
%:%2090=601%:%
%:%2091=602%:%
%:%2092=603%:%
%:%2093=604%:%
%:%2094=604%:%
%:%2097=605%:%
%:%2102=606%:%
